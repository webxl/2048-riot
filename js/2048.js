'use strict';

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol ? "symbol" : typeof obj; };

if (typeof Object.assign != 'function') {
  Object.assign = function (target) {
    'use strict';

    if (target == null) {
      throw new TypeError('Cannot convert undefined or null to object');
    }

    target = Object(target);
    for (var index = 1; index < arguments.length; index++) {
      var source = arguments[index];
      if (source != null) {
        for (var key in source) {
          if (Object.prototype.hasOwnProperty.call(source, key)) {
            target[key] = source[key];
          }
        }
      }
    }
    return target;
  };
}

function Game(_opts) {
  var _this = this;

  var DEFAULT_SIZE = 4;
  var DEFAULT_GOAL = 2048;
  var DEFAULT_NEW_BLOCK_COUNT = 1;
  var NEW_BLOCK_VAL_HIGH = 4;
  var NEW_BLOCK_VAL_LOW = 2;
  var HIGH_LOW_RATIO = .75;
  var HIGH_BLOCK_PERMITTED = 1 / 256;

  var opts = Object.assign({
    size: DEFAULT_SIZE,
    goal: DEFAULT_GOAL,
    newBlockCount: DEFAULT_NEW_BLOCK_COUNT

  }, _opts);

  this.boardUndoStack = [];
  this.boardRedoStack = [];
  this.score = 0;

  this.getStartBlocks = function (blocks, boardSize) {
    var loc = [Math.floor(boardSize * Math.random()), Math.floor(boardSize * Math.random())];
    if (!blocks.some(function (b) {
      return b[0] == loc[0] && b[1] == loc[1];
    })) {
      blocks.push(loc);
      return blocks;
    } else {
      return _this.getStartBlocks(blocks, boardSize);
    }
  };

  this.gameStatus = function () {
    return _this.status;
  };

  this.getNewBlocks = function (matrix, count, newBlocks) {
    if (0 == count--) return newBlocks;
    var boardSize = matrix.length,
        available = [];
    var newMatrix = cloneMatrix(matrix);
    for (var i = 0; i < boardSize; i++) {
      for (var j = 0; j < boardSize; j++) {
        if (!matrix[i][j].val) available.push({ y: i, x: j });
      }
    }

    if (!available.length) return newBlocks;

    var c = available[Math.floor(available.length * Math.random())];
    newBlocks.push(c);
    newMatrix[c.y][c.x].val = 2;
    return _this.getNewBlocks(newMatrix, count, newBlocks);
  };

  this.maybeGetBlock = function (blocks, x, y) {
    var val = blocks.some(function (b) {
      return b[0] == x && b[1] == y;
    }) ? 2 : 0;
    return { val: val, combined: false, startY: y, startX: x, moved: 0 };
  };

  this.newGame = function (newOpts) {
    _this.status = 'active';
    opts = Object.assign({}, opts, newOpts);
    _this.boardSize = opts.size;
    _this.maxBlockValue = 2;

    var gameBlocks = _this.getStartBlocks([], _this.boardSize);
    gameBlocks = _this.getStartBlocks(gameBlocks, _this.boardSize);

    _this.rows = [];
    for (var i = 0; i < _this.boardSize; i++) {
      var row = [];
      for (var j = 0; j < _this.boardSize; j++) {
        row.push(_this.maybeGetBlock(gameBlocks, i, j));
      }
      _this.rows.push(row);
    }
    _this.rows = _this.updateProps(_this.rows);
  };

  this.combineValuesUp = function (matrix, secondPass) {
    var size = matrix.length,
        combined = cloneMatrix(matrix);

    for (var x = 0; x < size; x++) {
      var size_r = size;
      for (var y = 0; y < size_r - 1; y++) {
        var curBlock = combined[y][x],
            nextBlock = combined[y + 1][x];

        if (curBlock.val === 0) {
          var y1 = void 0;
          for (y1 = y; y1 < size_r - 1; y1++) {
            combined[y1][x] = Object.assign({}, combined[y1 + 1][x]);
          }
          combined[y1][x].val = 0;
          y--;size_r--;
        } else {
          if (curBlock.val === nextBlock.val && !curBlock.combined && !nextBlock.combined) {
            var _y = void 0;
            var newValue = curBlock.val * 2;
            //this.score += newValue;

            combined[y][x] = Object.assign({}, nextBlock, { combined: { y: curBlock.startY, x: curBlock.startX }, val: newValue });
            nextBlock.val = 0;
            for (_y = y + 1; _y < size_r - 1; _y++) {
              combined[_y][x] = Object.assign({}, combined[_y + 1][x]);
            }
            combined[_y][x].val = 0;
            y--;size_r--;
          }
        }
      }
    }

    if (!secondPass) {
      return _this.combineValuesUp(combined, true);
    }
    return combined;
  };

  this.getBlockMovements = function (direction) {
    var size = _this.rows.length,
        blocks = [];

    var preview = _this.moveBlocks(direction);

    for (var y = 0; y < size; y++) {
      blocks.push(new Array(size));
      for (var x = 0; x < size; x++) {
        blocks[y][x] = 0;
      }
    }
    for (var _y2 = 0; _y2 < size; _y2++) {
      for (var _x = 0; _x < size; _x++) {
        //  let block = this.rows[y][x];
        var newBlock = preview[_y2][_x];

        var dx = 0,
            dy = 0;

        switch (direction) {
          case 'up':
          case 'down':
            dy = _y2 - newBlock.startY;break;
          case 'left':
          case 'right':
            dx = _x - newBlock.startX;break;
        }
        //console.log(y,x,dy,dx,n,block,newBlock)

        if ((dy || dx) && newBlock.val) blocks[newBlock.startY][newBlock.startX] = { dy: dy, dx: dx };

        if (newBlock.combined) {
          var _dx = 0,
              _dy = 0;
          switch (direction) {
            case 'up':
            case 'down':
              _dy = _y2 - newBlock.combined.y;break;
            case 'left':
            case 'right':
              _dx = _x - newBlock.combined.x;break;
          }
          //console.log(y,x,dy,dx,newBlock.combined)

          if ((_dy || _dx) && newBlock.val) blocks[newBlock.combined.y][newBlock.combined.x] = { dy: _dy, dx: _dx, removed: true };
          blocks[_y2][_x] = Object.assign({ combined: true }, blocks[_y2][_x]);
        }
      }
    }

    return blocks;
  };

  this.possibleMoves = function (matrix, y, x) {
    var size = _this.rows.length,
        moves = [];
    var nbs = [[-1, 0, 'up'], [0, -1, 'left'], [0, 1, 'right'], [1, 0, 'down']];
    for (var j = 0; j < nbs.length; j++) {
      var y1 = y + nbs[j][0],
          x1 = x + nbs[j][1];
      if (x1 >= 0 && y1 >= 0 && x1 < size && y1 < size) {
        if (matrix[y][x].val && (matrix[y1][x1].val == matrix[y][x].val || !matrix[y1][x1].val)) moves.push(nbs[j][2]);
      }
    }
    return moves;
  };

  this.getNewBlockValue = function (notRandom) {
    return _this.maxBlockValue >= opts.goal * HIGH_BLOCK_PERMITTED && (notRandom || Math.random() > HIGH_LOW_RATIO) ? NEW_BLOCK_VAL_HIGH : NEW_BLOCK_VAL_LOW;
  };

  this.processMove = function (direction) {

    var size = _this.rows.length,
        moves = [];

    if (_this.status !== 'active') return;

    for (var y = 0; y < size; y++) {
      for (var x = 0; x < size; x++) {
        if (_this.rows[y][x].possibleMoves.length) moves.push(_this.rows[y][x].possibleMoves);
      }
    }

    if (!moves.some(function (b) {
      return b.some(function (m) {
        return m === direction;
      });
    })) return;

    _this.boardUndoStack.push(_this.rows);
    _this.boardRedoStack = [];

    _this.rows = _this.moveBlocks(direction);

    if (_this.checkWin()) return;

    _this.newBlocks = _this.getNewBlocks(_this.rows, opts.newBlockCount, []);
    var newVal = _this.getNewBlockValue();
    _this.newBlocks.forEach(function (c) {
      Object.assign(_this.rows[c.y][c.x], getDefaults(c.y, c.x, newVal, null), { isNew: true });
    });

    _this.score += _this.getMoveScore(_this.rows);

    _this.rows = _this.updateProps(_this.rows);

    _this.checkLoss();
  };

  this.checkWin = function () {
    var size = _this.rows.length;
    for (var y = 0; y < size; y++) {
      for (var x = 0; x < size; x++) {
        if (_this.rows[y][x].val >= _this.maxBlockValue) {
          _this.maxBlockValue = _this.rows[y][x].val;
        }
      }
    }

    if (_this.maxBlockValue >= opts.goal) {
      _this.status = 'win';
      return true;
    }

    return false;
  };

  this.checkLoss = function () {
    var size = _this.rows.length,
        moves = [];
    for (var y = 0; y < size; y++) {
      for (var x = 0; x < size; x++) {
        moves.push(_this.rows[y][x].possibleMoves);
      }
    }
    if (!moves.some(function (b) {
      return b.length != 0;
    })) {
      _this.status = 'loss';return true;
    }

    return false;
  };

  this.moveBlocks = function (direction) {
    return _this.transformMatrix(direction, _this.combineValuesUp);
  };

  this.undo = function () {
    if (_this.boardUndoStack.length) {
      _this.status = 'active';
      var redo = _this.rows;
      _this.rows = _this.boardUndoStack.pop();
      _this.boardRedoStack.push(redo);
    }
  };

  this.redo = function () {
    if (_this.boardRedoStack.length) {
      var undo = _this.rows;
      _this.rows = _this.boardRedoStack.pop();
      _this.boardUndoStack.push(undo);
      _this.checkWin();
      _this.checkLoss();
    }
  };

  // matrix helpers

  this.transpose = function (matrix) {
    var size = matrix.length,
        trans = new Array(size);
    for (var y = 0; y < size; y++) {
      trans[y] = new Array(size);
      for (var x = 0; x < size; x++) {
        trans[y][x] = Object.assign({}, matrix[x][y]);
      }
    }
    return trans;
  };

  this.reverseEachRow = function (matrix) {

    var size = matrix.length,
        reversed = new Array(size);
    for (var y = 0; y < size; y++) {
      reversed[y] = new Array(size);
      for (var x = 0; x < size; x++) {
        reversed[y][x] = Object.assign({}, matrix[y][size - x - 1]);
      }
    }
    return reversed;
  };

  this.reverseEachColumn = function (matrix) {

    var size = matrix.length,
        reversed = new Array(size);
    for (var y = 0; y < size; y++) {
      reversed[y] = new Array(size);
      for (var x = 0; x < size; x++) {
        reversed[y][x] = Object.assign({}, matrix[size - y - 1][x]);
      }
      //reversed[y] = Object.assign({}, matrix[size - y - 1]);
    }
    return reversed;
  };

  this.printMatrix = function (matrix) {
    var size = matrix.length;
    console.log('----');
    for (var y = 0; y < size; y++) {
      var row = '';
      for (var x = 0; x < size; x++) {
        row += matrix[y][x].val + ' ';
      }
      console.log(row);
    }
    console.log('----');
  };

  this.rotate = function (direction, matrix) {
    switch (direction) {
      case 'left':
        return _this.reverseEachColumn(_this.transpose(matrix));
      case 'right':
        return _this.reverseEachRow(_this.transpose(matrix));
      default:
        break;
    }
    return matrix;
  };

  this.flip = function (matrix) {
    return _this.reverseEachRow(_this.reverseEachColumn(cloneMatrix(matrix)));
  };

  this.transformMatrix = function (direction, combineFn) {
    switch (direction) {
      case 'left':
        return _this.rotate('left', combineFn.call(_this, _this.rotate('right', _this.rows)));
        break;
      case 'right':
        return _this.rotate('right', combineFn.call(_this, _this.rotate('left', _this.rows)));
        break;
      case 'up':
        return combineFn.call(_this, _this.rows);
        break;
      case 'down':
        return _this.flip(combineFn.call(_this, _this.flip(_this.rows)));
        break;
      default:
        return;break;
    }
  };

  this.addProps = function (matrix) {
    var size = matrix.length,
        newMatrix = new Array(size);
    for (var y = 0; y < size; y++) {
      newMatrix[y] = new Array(size);
      for (var x = 0; x < size; x++) {
        newMatrix[y][x] = getDefaults(y, x, matrix[y][x], []);
      }
    }
    return _this.updateProps(newMatrix);
  };

  this.removeProps = function (matrix) {
    var size = matrix.length,
        newMatrix = new Array(size);
    for (var y = 0; y < size; y++) {
      newMatrix[y] = Array(size);
      for (var x = 0; x < size; x++) {
        newMatrix[y][x] = matrix[y][x].val;
      }
    }
    return newMatrix;
  };

  this.updateProps = function (matrix) {
    var size = matrix.length,
        newMatrix = new Array(size);
    for (var y = 0; y < size; y++) {
      newMatrix[y] = new Array(size);
      for (var x = 0; x < size; x++) {
        newMatrix[y][x] = getDefaults(y, x, matrix[y][x].val, _this.possibleMoves(matrix, y, x));
      }
    }
    return newMatrix;
  };

  this.getMoveScore = function (matrix) {
    var moveScore = 0;
    var size = matrix.length;
    for (var y = 0; y < size; y++) {
      for (var x = 0; x < size; x++) {
        if (matrix[y][x].combined) {
          moveScore += matrix[y][x].val;
        }
      }
    }
    return moveScore;
  };

  function getDefaults(y, x, val, moves) {
    return {
      val: val,
      combined: false,
      startY: y,
      startX: x,
      moved: 0,
      possibleMoves: moves,
      isNew: false
    };
  }
  function cloneMatrix(matrix) {
    var size = matrix.length,
        newMatrix = new Array(size);
    for (var y = 0; y < size; y++) {
      newMatrix[y] = Array(size);
      for (var x = 0; x < size; x++) {
        if (_typeof(matrix[y][x]) == 'object') newMatrix[y][x] = Object.assign({}, matrix[y][x]);
        //else
        //newMatrix[y][x] = matrix[y][x];
      }
    }
    return newMatrix;
  }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdhbWUuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLElBQUksT0FBTyxPQUFPLE1BQWQsSUFBd0IsVUFBNUIsRUFBd0M7QUFDdEMsU0FBTyxNQUFQLEdBQWdCLFVBQVMsTUFBVCxFQUFpQjtBQUMvQjs7QUFDQSxRQUFJLFVBQVUsSUFBZCxFQUFvQjtBQUNsQixZQUFNLElBQUksU0FBSixDQUFjLDRDQUFkLENBQU47QUFDRDs7QUFFRCxhQUFTLE9BQU8sTUFBUCxDQUFUO0FBQ0EsU0FBSyxJQUFJLFFBQVEsQ0FBakIsRUFBb0IsUUFBUSxVQUFVLE1BQXRDLEVBQThDLE9BQTlDLEVBQXVEO0FBQ3JELFVBQU0sU0FBUyxVQUFVLEtBQVYsQ0FBZjtBQUNBLFVBQUksVUFBVSxJQUFkLEVBQW9CO0FBQ2xCLGFBQUssSUFBSSxHQUFULElBQWdCLE1BQWhCLEVBQXdCO0FBQ3RCLGNBQUksT0FBTyxTQUFQLENBQWlCLGNBQWpCLENBQWdDLElBQWhDLENBQXFDLE1BQXJDLEVBQTZDLEdBQTdDLENBQUosRUFBdUQ7QUFDckQsbUJBQU8sR0FBUCxJQUFjLE9BQU8sR0FBUCxDQUFkO0FBQ0Q7QUFDRjtBQUNGO0FBQ0Y7QUFDRCxXQUFPLE1BQVA7QUFDRCxHQWxCRDtBQW1CRDs7QUFFRCxTQUFTLElBQVQsQ0FBYyxLQUFkLEVBQXFCO0FBQUE7O0FBRW5CLE1BQU0sZUFBZSxDQUFyQjtBQUNBLE1BQU0sZUFBZSxJQUFyQjtBQUNBLE1BQU0sMEJBQTBCLENBQWhDO0FBQ0EsTUFBTSxxQkFBcUIsQ0FBM0I7QUFDQSxNQUFNLG9CQUFvQixDQUExQjtBQUNBLE1BQU0saUJBQWlCLEdBQXZCO0FBQ0EsTUFBTSx1QkFBdUIsSUFBSSxHQUFqQzs7QUFFQSxNQUFJLE9BQU8sT0FBTyxNQUFQLENBQWM7QUFDdkIsVUFBTSxZQURpQjtBQUV2QixVQUFNLFlBRmlCO0FBR3ZCLG1CQUFlOztBQUhRLEdBQWQsRUFLUixLQUxRLENBQVg7O0FBT0EsT0FBSyxjQUFMLEdBQXNCLEVBQXRCO0FBQ0EsT0FBSyxjQUFMLEdBQXNCLEVBQXRCO0FBQ0EsT0FBSyxLQUFMLEdBQWEsQ0FBYjs7QUFFQSxPQUFLLGNBQUwsR0FBc0IsVUFBQyxNQUFELEVBQVMsU0FBVCxFQUF1QjtBQUMzQyxRQUFNLE1BQU0sQ0FBQyxLQUFLLEtBQUwsQ0FBVyxZQUFZLEtBQUssTUFBTCxFQUF2QixDQUFELEVBQXdDLEtBQUssS0FBTCxDQUFXLFlBQVksS0FBSyxNQUFMLEVBQXZCLENBQXhDLENBQVo7QUFDQSxRQUFJLENBQUMsT0FBTyxJQUFQLENBQVk7QUFBQSxhQUFLLEVBQUUsQ0FBRixLQUFRLElBQUksQ0FBSixDQUFSLElBQWtCLEVBQUUsQ0FBRixLQUFRLElBQUksQ0FBSixDQUEvQjtBQUFBLEtBQVosQ0FBTCxFQUF5RDtBQUN2RCxhQUFPLElBQVAsQ0FBWSxHQUFaO0FBQ0EsYUFBTyxNQUFQO0FBQ0QsS0FIRCxNQUdPO0FBQ0wsYUFBTyxNQUFLLGNBQUwsQ0FBb0IsTUFBcEIsRUFBNEIsU0FBNUIsQ0FBUDtBQUNEO0FBQ0YsR0FSRDs7QUFVQSxPQUFLLFVBQUwsR0FBa0IsWUFBTTtBQUN0QixXQUFPLE1BQUssTUFBWjtBQUNELEdBRkQ7O0FBSUEsT0FBSyxZQUFMLEdBQW9CLFVBQUMsTUFBRCxFQUFTLEtBQVQsRUFBZ0IsU0FBaEIsRUFBOEI7QUFDaEQsUUFBSSxLQUFLLE9BQVQsRUFBa0IsT0FBTyxTQUFQO0FBQ2xCLFFBQU0sWUFBWSxPQUFPLE1BQXpCO0FBQUEsUUFBaUMsWUFBWSxFQUE3QztBQUNBLFFBQU0sWUFBWSxZQUFZLE1BQVosQ0FBbEI7QUFDQSxTQUFLLElBQUksSUFBSSxDQUFiLEVBQWdCLElBQUksU0FBcEIsRUFBK0IsR0FBL0IsRUFBb0M7QUFDbEMsV0FBSyxJQUFJLElBQUksQ0FBYixFQUFnQixJQUFJLFNBQXBCLEVBQStCLEdBQS9CLEVBQW9DO0FBQ2xDLFlBQUksQ0FBQyxPQUFPLENBQVAsRUFBVSxDQUFWLEVBQWEsR0FBbEIsRUFBdUIsVUFBVSxJQUFWLENBQWUsRUFBQyxHQUFHLENBQUosRUFBTyxHQUFHLENBQVYsRUFBZjtBQUN4QjtBQUNGOztBQUVELFFBQUksQ0FBQyxVQUFVLE1BQWYsRUFBdUIsT0FBTyxTQUFQOztBQUV2QixRQUFNLElBQUksVUFBVSxLQUFLLEtBQUwsQ0FBVyxVQUFVLE1BQVYsR0FBbUIsS0FBSyxNQUFMLEVBQTlCLENBQVYsQ0FBVjtBQUNBLGNBQVUsSUFBVixDQUFlLENBQWY7QUFDQSxjQUFVLEVBQUUsQ0FBWixFQUFlLEVBQUUsQ0FBakIsRUFBb0IsR0FBcEIsR0FBMEIsQ0FBMUI7QUFDQSxXQUFPLE1BQUssWUFBTCxDQUFrQixTQUFsQixFQUE2QixLQUE3QixFQUFvQyxTQUFwQyxDQUFQO0FBQ0QsR0FoQkQ7O0FBa0JBLE9BQUssYUFBTCxHQUFxQixVQUFDLE1BQUQsRUFBUyxDQUFULEVBQVksQ0FBWixFQUFrQjtBQUNyQyxRQUFNLE1BQU0sT0FBTyxJQUFQLENBQVk7QUFBQSxhQUFLLEVBQUUsQ0FBRixLQUFRLENBQVIsSUFBYSxFQUFFLENBQUYsS0FBUSxDQUExQjtBQUFBLEtBQVosSUFBMkMsQ0FBM0MsR0FBK0MsQ0FBM0Q7QUFDQSxXQUFPLEVBQUUsUUFBRixFQUFPLFVBQVUsS0FBakIsRUFBd0IsUUFBUSxDQUFoQyxFQUFtQyxRQUFRLENBQTNDLEVBQThDLE9BQU8sQ0FBckQsRUFBUDtBQUNELEdBSEQ7O0FBS0EsT0FBSyxPQUFMLEdBQWUsVUFBQyxPQUFELEVBQWE7QUFDMUIsVUFBSyxNQUFMLEdBQWMsUUFBZDtBQUNBLFdBQU8sT0FBTyxNQUFQLENBQWMsRUFBZCxFQUFrQixJQUFsQixFQUF3QixPQUF4QixDQUFQO0FBQ0EsVUFBSyxTQUFMLEdBQWlCLEtBQUssSUFBdEI7QUFDQSxVQUFLLGFBQUwsR0FBcUIsQ0FBckI7O0FBRUEsUUFBSSxhQUFhLE1BQUssY0FBTCxDQUFvQixFQUFwQixFQUF3QixNQUFLLFNBQTdCLENBQWpCO0FBQ0EsaUJBQWEsTUFBSyxjQUFMLENBQW9CLFVBQXBCLEVBQWdDLE1BQUssU0FBckMsQ0FBYjs7QUFFQSxVQUFLLElBQUwsR0FBWSxFQUFaO0FBQ0EsU0FBSyxJQUFJLElBQUksQ0FBYixFQUFnQixJQUFJLE1BQUssU0FBekIsRUFBb0MsR0FBcEMsRUFBeUM7QUFDdkMsVUFBTSxNQUFNLEVBQVo7QUFDQSxXQUFLLElBQUksSUFBSSxDQUFiLEVBQWdCLElBQUksTUFBSyxTQUF6QixFQUFvQyxHQUFwQyxFQUF5QztBQUN2QyxZQUFJLElBQUosQ0FBUyxNQUFLLGFBQUwsQ0FBbUIsVUFBbkIsRUFBK0IsQ0FBL0IsRUFBa0MsQ0FBbEMsQ0FBVDtBQUNEO0FBQ0QsWUFBSyxJQUFMLENBQVUsSUFBVixDQUFlLEdBQWY7QUFDRDtBQUNELFVBQUssSUFBTCxHQUFZLE1BQUssV0FBTCxDQUFpQixNQUFLLElBQXRCLENBQVo7QUFDRCxHQWxCRDs7QUFvQkEsT0FBSyxlQUFMLEdBQXVCLFVBQUMsTUFBRCxFQUFTLFVBQVQsRUFBd0I7QUFDN0MsUUFBTSxPQUFPLE9BQU8sTUFBcEI7QUFBQSxRQUE0QixXQUFXLFlBQVksTUFBWixDQUF2Qzs7QUFFQSxTQUFLLElBQUksSUFBSSxDQUFiLEVBQWdCLElBQUksSUFBcEIsRUFBMEIsR0FBMUIsRUFBK0I7QUFDN0IsVUFBSSxTQUFTLElBQWI7QUFDQSxXQUFLLElBQUksSUFBSSxDQUFiLEVBQWdCLElBQUksU0FBUyxDQUE3QixFQUFnQyxHQUFoQyxFQUFxQztBQUNuQyxZQUFJLFdBQVcsU0FBUyxDQUFULEVBQVksQ0FBWixDQUFmO0FBQUEsWUFDRSxZQUFZLFNBQVMsSUFBSSxDQUFiLEVBQWdCLENBQWhCLENBRGQ7O0FBR0EsWUFBSSxTQUFTLEdBQVQsS0FBaUIsQ0FBckIsRUFBd0I7QUFDdEIsY0FBSSxXQUFKO0FBQ0EsZUFBSyxLQUFLLENBQVYsRUFBYSxLQUFLLFNBQVMsQ0FBM0IsRUFBOEIsSUFBOUIsRUFBb0M7QUFDbEMscUJBQVMsRUFBVCxFQUFhLENBQWIsSUFBa0IsT0FBTyxNQUFQLENBQWMsRUFBZCxFQUFrQixTQUFTLEtBQUssQ0FBZCxFQUFpQixDQUFqQixDQUFsQixDQUFsQjtBQUNEO0FBQ0QsbUJBQVMsRUFBVCxFQUFhLENBQWIsRUFBZ0IsR0FBaEIsR0FBc0IsQ0FBdEI7QUFDQSxjQUFLO0FBQ04sU0FQRCxNQU9PO0FBQ0wsY0FBSSxTQUFTLEdBQVQsS0FBaUIsVUFBVSxHQUEzQixJQUFrQyxDQUFDLFNBQVMsUUFBNUMsSUFBd0QsQ0FBQyxVQUFVLFFBQXZFLEVBQWlGO0FBQy9FLGdCQUFJLFdBQUo7QUFDQSxnQkFBTSxXQUFXLFNBQVMsR0FBVCxHQUFlLENBQWhDOzs7QUFHQSxxQkFBUyxDQUFULEVBQVksQ0FBWixJQUFpQixPQUFPLE1BQVAsQ0FBYyxFQUFkLEVBQWtCLFNBQWxCLEVBQTZCLEVBQUUsVUFBVSxFQUFFLEdBQUcsU0FBUyxNQUFkLEVBQXNCLEdBQUcsU0FBUyxNQUFsQyxFQUFaLEVBQXdELEtBQUssUUFBN0QsRUFBN0IsQ0FBakI7QUFDQSxzQkFBVSxHQUFWLEdBQWdCLENBQWhCO0FBQ0EsaUJBQUssS0FBSyxJQUFFLENBQVosRUFBZSxLQUFLLFNBQVMsQ0FBN0IsRUFBZ0MsSUFBaEMsRUFBc0M7QUFDcEMsdUJBQVMsRUFBVCxFQUFhLENBQWIsSUFBa0IsT0FBTyxNQUFQLENBQWMsRUFBZCxFQUFtQixTQUFTLEtBQUssQ0FBZCxFQUFpQixDQUFqQixDQUFuQixDQUFsQjtBQUNEO0FBQ0QscUJBQVMsRUFBVCxFQUFhLENBQWIsRUFBZ0IsR0FBaEIsR0FBc0IsQ0FBdEI7QUFDQSxnQkFBSztBQUNOO0FBQ0Y7QUFDRjtBQUNGOztBQUVELFFBQUksQ0FBQyxVQUFMLEVBQWlCO0FBQ2YsYUFBTyxNQUFLLGVBQUwsQ0FBcUIsUUFBckIsRUFBK0IsSUFBL0IsQ0FBUDtBQUNEO0FBQ0QsV0FBTyxRQUFQO0FBQ0QsR0F0Q0Q7O0FBd0NBLE9BQUssaUJBQUwsR0FBeUIscUJBQWE7QUFDcEMsUUFBTSxPQUFPLE1BQUssSUFBTCxDQUFVLE1BQXZCO0FBQUEsUUFBK0IsU0FBUyxFQUF4Qzs7QUFFQSxRQUFNLFVBQVUsTUFBSyxVQUFMLENBQWdCLFNBQWhCLENBQWhCOztBQUVBLFNBQUssSUFBSSxJQUFJLENBQWIsRUFBZ0IsSUFBSSxJQUFwQixFQUEwQixHQUExQixFQUErQjtBQUM3QixhQUFPLElBQVAsQ0FBWSxJQUFJLEtBQUosQ0FBVSxJQUFWLENBQVo7QUFDQSxXQUFLLElBQUksSUFBSSxDQUFiLEVBQWdCLElBQUksSUFBcEIsRUFBMEIsR0FBMUIsRUFBK0I7QUFDN0IsZUFBTyxDQUFQLEVBQVUsQ0FBVixJQUFlLENBQWY7QUFDRDtBQUNGO0FBQ0QsU0FBSyxJQUFJLE1BQUksQ0FBYixFQUFnQixNQUFJLElBQXBCLEVBQTBCLEtBQTFCLEVBQStCO0FBQzdCLFdBQUssSUFBSSxLQUFJLENBQWIsRUFBZ0IsS0FBSSxJQUFwQixFQUEwQixJQUExQixFQUErQjs7QUFFN0IsWUFBSSxXQUFXLFFBQVEsR0FBUixFQUFXLEVBQVgsQ0FBZjs7QUFFQSxZQUFJLEtBQUssQ0FBVDtBQUFBLFlBQVksS0FBSyxDQUFqQjs7QUFFQSxnQkFBUSxTQUFSO0FBQ0UsZUFBSyxJQUFMO0FBQ0EsZUFBSyxNQUFMO0FBQ0UsaUJBQUssTUFBSSxTQUFTLE1BQWxCLENBQTBCO0FBQzVCLGVBQUssTUFBTDtBQUNBLGVBQUssT0FBTDtBQUNFLGlCQUFLLEtBQUksU0FBUyxNQUFsQixDQUEyQjtBQU4vQjs7O0FBVUEsWUFBSSxDQUFDLE1BQU0sRUFBUCxLQUFlLFNBQVMsR0FBNUIsRUFDRSxPQUFPLFNBQVMsTUFBaEIsRUFBd0IsU0FBUyxNQUFqQyxJQUEyQyxFQUFFLE1BQUYsRUFBTSxNQUFOLEVBQTNDOztBQUVGLFlBQUksU0FBUyxRQUFiLEVBQXVCO0FBQ3JCLGNBQUksTUFBSyxDQUFUO0FBQUEsY0FBWSxNQUFLLENBQWpCO0FBQ0Esa0JBQVEsU0FBUjtBQUNFLGlCQUFLLElBQUw7QUFDQSxpQkFBSyxNQUFMO0FBQ0Usb0JBQUssTUFBSSxTQUFTLFFBQVQsQ0FBa0IsQ0FBM0IsQ0FBOEI7QUFDaEMsaUJBQUssTUFBTDtBQUNBLGlCQUFLLE9BQUw7QUFDRSxvQkFBSyxLQUFJLFNBQVMsUUFBVCxDQUFrQixDQUEzQixDQUErQjtBQU5uQzs7O0FBVUEsY0FBSSxDQUFDLE9BQU0sR0FBUCxLQUFlLFNBQVMsR0FBNUIsRUFDRSxPQUFPLFNBQVMsUUFBVCxDQUFrQixDQUF6QixFQUE0QixTQUFTLFFBQVQsQ0FBa0IsQ0FBOUMsSUFBbUQsRUFBRSxPQUFGLEVBQU0sT0FBTixFQUFVLFNBQVMsSUFBbkIsRUFBbkQ7QUFDQSxpQkFBTyxHQUFQLEVBQVUsRUFBVixJQUFlLE9BQU8sTUFBUCxDQUFjLEVBQUUsVUFBVSxJQUFaLEVBQWQsRUFBa0MsT0FBTyxHQUFQLEVBQVUsRUFBVixDQUFsQyxDQUFmO0FBQ0g7QUFDRjtBQUNGOztBQUVELFdBQU8sTUFBUDtBQUNELEdBbkREOztBQXFEQSxPQUFLLGFBQUwsR0FBcUIsVUFBQyxNQUFELEVBQVMsQ0FBVCxFQUFZLENBQVosRUFBbUI7QUFDdEMsUUFBTSxPQUFPLE1BQUssSUFBTCxDQUFVLE1BQXZCO0FBQUEsUUFBK0IsUUFBUSxFQUF2QztBQUNBLFFBQU0sTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFGLEVBQUssQ0FBTCxFQUFRLElBQVIsQ0FBRCxFQUFnQixDQUFDLENBQUQsRUFBSSxDQUFDLENBQUwsRUFBUSxNQUFSLENBQWhCLEVBQWlDLENBQUMsQ0FBRCxFQUFJLENBQUosRUFBTyxPQUFQLENBQWpDLEVBQWtELENBQUMsQ0FBRCxFQUFJLENBQUosRUFBTyxNQUFQLENBQWxELENBQVo7QUFDQSxTQUFLLElBQUksSUFBRSxDQUFYLEVBQWMsSUFBRSxJQUFJLE1BQXBCLEVBQTRCLEdBQTVCLEVBQWlDO0FBQy9CLFVBQU0sS0FBSyxJQUFJLElBQUksQ0FBSixFQUFPLENBQVAsQ0FBZjtBQUFBLFVBQTBCLEtBQUssSUFBSSxJQUFJLENBQUosRUFBTyxDQUFQLENBQW5DO0FBQ0EsVUFBSSxNQUFNLENBQU4sSUFBVyxNQUFNLENBQWpCLElBQXNCLEtBQUssSUFBM0IsSUFBbUMsS0FBSyxJQUE1QyxFQUFrRDtBQUNoRCxZQUFJLE9BQU8sQ0FBUCxFQUFVLENBQVYsRUFBYSxHQUFiLEtBQXFCLE9BQU8sRUFBUCxFQUFXLEVBQVgsRUFBZSxHQUFmLElBQXNCLE9BQU8sQ0FBUCxFQUFVLENBQVYsRUFBYSxHQUFuQyxJQUEwQyxDQUFDLE9BQU8sRUFBUCxFQUFXLEVBQVgsRUFBZSxHQUEvRSxDQUFKLEVBQ0UsTUFBTSxJQUFOLENBQVcsSUFBSSxDQUFKLEVBQU8sQ0FBUCxDQUFYO0FBQ0g7QUFDRjtBQUNELFdBQU8sS0FBUDtBQUNELEdBWEQ7O0FBY0EsT0FBSyxnQkFBTCxHQUF3QixVQUFDLFNBQUQ7QUFBQSxXQUFnQixNQUFLLGFBQUwsSUFBc0IsS0FBSyxJQUFMLEdBQVksb0JBQWxDLEtBQTJELGFBQWEsS0FBSyxNQUFMLEtBQWdCLGNBQXhGLENBQUQsR0FBNEcsa0JBQTVHLEdBQWdJLGlCQUEvSTtBQUFBLEdBQXhCOztBQUVBLE9BQUssV0FBTCxHQUFtQixxQkFBYTs7QUFFOUIsUUFBTSxPQUFPLE1BQUssSUFBTCxDQUFVLE1BQXZCO0FBQUEsUUFBK0IsUUFBUSxFQUF2Qzs7QUFFQSxRQUFJLE1BQUssTUFBTCxLQUFnQixRQUFwQixFQUNFOztBQUVGLFNBQUssSUFBSSxJQUFJLENBQWIsRUFBZ0IsSUFBSSxJQUFwQixFQUEwQixHQUExQixFQUErQjtBQUM3QixXQUFLLElBQUksSUFBSSxDQUFiLEVBQWdCLElBQUksSUFBcEIsRUFBMEIsR0FBMUIsRUFBK0I7QUFDN0IsWUFBSSxNQUFLLElBQUwsQ0FBVSxDQUFWLEVBQWEsQ0FBYixFQUFnQixhQUFoQixDQUE4QixNQUFsQyxFQUNBLE1BQU0sSUFBTixDQUFXLE1BQUssSUFBTCxDQUFVLENBQVYsRUFBYSxDQUFiLEVBQWdCLGFBQTNCO0FBQ0Q7QUFDRjs7QUFFRCxRQUFJLENBQUMsTUFBTSxJQUFOLENBQVc7QUFBQSxhQUFLLEVBQUUsSUFBRixDQUFPO0FBQUEsZUFBSyxNQUFNLFNBQVg7QUFBQSxPQUFQLENBQUw7QUFBQSxLQUFYLENBQUwsRUFDRTs7QUFFRixVQUFLLGNBQUwsQ0FBb0IsSUFBcEIsQ0FBMEIsTUFBSyxJQUEvQjtBQUNBLFVBQUssY0FBTCxHQUFzQixFQUF0Qjs7QUFFQSxVQUFLLElBQUwsR0FBWSxNQUFLLFVBQUwsQ0FBZ0IsU0FBaEIsQ0FBWjs7QUFFQSxRQUFJLE1BQUssUUFBTCxFQUFKLEVBQXFCOztBQUVyQixVQUFLLFNBQUwsR0FBaUIsTUFBSyxZQUFMLENBQWtCLE1BQUssSUFBdkIsRUFBNkIsS0FBSyxhQUFsQyxFQUFpRCxFQUFqRCxDQUFqQjtBQUNBLFFBQU0sU0FBUyxNQUFLLGdCQUFMLEVBQWY7QUFDQSxVQUFLLFNBQUwsQ0FBZSxPQUFmLENBQXVCLGFBQUs7QUFDMUIsYUFBTyxNQUFQLENBQWMsTUFBSyxJQUFMLENBQVUsRUFBRSxDQUFaLEVBQWUsRUFBRSxDQUFqQixDQUFkLEVBQW1DLFlBQVksRUFBRSxDQUFkLEVBQWlCLEVBQUUsQ0FBbkIsRUFBc0IsTUFBdEIsRUFBOEIsSUFBOUIsQ0FBbkMsRUFBd0UsRUFBRSxPQUFPLElBQVQsRUFBeEU7QUFFRCxLQUhEOztBQUtBLFVBQUssS0FBTCxJQUFjLE1BQUssWUFBTCxDQUFrQixNQUFLLElBQXZCLENBQWQ7O0FBRUEsVUFBSyxJQUFMLEdBQVksTUFBSyxXQUFMLENBQWlCLE1BQUssSUFBdEIsQ0FBWjs7QUFFQSxVQUFLLFNBQUw7QUFFRCxHQXJDRDs7QUF1Q0EsT0FBSyxRQUFMLEdBQWdCLFlBQU07QUFDcEIsUUFBTSxPQUFPLE1BQUssSUFBTCxDQUFVLE1BQXZCO0FBQ0EsU0FBSyxJQUFJLElBQUksQ0FBYixFQUFnQixJQUFJLElBQXBCLEVBQTBCLEdBQTFCLEVBQStCO0FBQzdCLFdBQUssSUFBSSxJQUFJLENBQWIsRUFBZ0IsSUFBSSxJQUFwQixFQUEwQixHQUExQixFQUErQjtBQUM3QixZQUFJLE1BQUssSUFBTCxDQUFVLENBQVYsRUFBYSxDQUFiLEVBQWdCLEdBQWhCLElBQXVCLE1BQUssYUFBaEMsRUFBK0M7QUFDN0MsZ0JBQUssYUFBTCxHQUFxQixNQUFLLElBQUwsQ0FBVSxDQUFWLEVBQWEsQ0FBYixFQUFnQixHQUFyQztBQUNEO0FBQ0Y7QUFDRjs7QUFFRCxRQUFJLE1BQUssYUFBTCxJQUFzQixLQUFLLElBQS9CLEVBQXFDO0FBQ25DLFlBQUssTUFBTCxHQUFjLEtBQWQ7QUFDQSxhQUFPLElBQVA7QUFDRDs7QUFFRCxXQUFPLEtBQVA7QUFDRCxHQWhCRDs7QUFrQkEsT0FBSyxTQUFMLEdBQWlCLFlBQU07QUFDckIsUUFBTSxPQUFPLE1BQUssSUFBTCxDQUFVLE1BQXZCO0FBQUEsUUFBK0IsUUFBUSxFQUF2QztBQUNBLFNBQUssSUFBSSxJQUFJLENBQWIsRUFBZ0IsSUFBSSxJQUFwQixFQUEwQixHQUExQixFQUErQjtBQUM3QixXQUFLLElBQUksSUFBSSxDQUFiLEVBQWdCLElBQUksSUFBcEIsRUFBMEIsR0FBMUIsRUFBK0I7QUFDN0IsY0FBTSxJQUFOLENBQVcsTUFBSyxJQUFMLENBQVUsQ0FBVixFQUFhLENBQWIsRUFBZ0IsYUFBM0I7QUFDRDtBQUNGO0FBQ0QsUUFBSSxDQUFDLE1BQU0sSUFBTixDQUFXO0FBQUEsYUFBSyxFQUFFLE1BQUYsSUFBWSxDQUFqQjtBQUFBLEtBQVgsQ0FBTCxFQUFxQztBQUNuQyxZQUFLLE1BQUwsR0FBYyxNQUFkLENBQXNCLE9BQU8sSUFBUDtBQUN2Qjs7QUFFRCxXQUFPLEtBQVA7QUFDRCxHQVpEOztBQWNBLE9BQUssVUFBTCxHQUFrQjtBQUFBLFdBQWEsTUFBSyxlQUFMLENBQXFCLFNBQXJCLEVBQWdDLE1BQUssZUFBckMsQ0FBYjtBQUFBLEdBQWxCOztBQUVBLE9BQUssSUFBTCxHQUFZLFlBQU07QUFDaEIsUUFBSSxNQUFLLGNBQUwsQ0FBb0IsTUFBeEIsRUFBZ0M7QUFDOUIsWUFBSyxNQUFMLEdBQWMsUUFBZDtBQUNBLFVBQU0sT0FBTyxNQUFLLElBQWxCO0FBQ0EsWUFBSyxJQUFMLEdBQVksTUFBSyxjQUFMLENBQW9CLEdBQXBCLEVBQVo7QUFDQSxZQUFLLGNBQUwsQ0FBb0IsSUFBcEIsQ0FBeUIsSUFBekI7QUFDRDtBQUNGLEdBUEQ7O0FBU0EsT0FBSyxJQUFMLEdBQVksWUFBTTtBQUNoQixRQUFJLE1BQUssY0FBTCxDQUFvQixNQUF4QixFQUFnQztBQUM5QixVQUFNLE9BQU8sTUFBSyxJQUFsQjtBQUNBLFlBQUssSUFBTCxHQUFZLE1BQUssY0FBTCxDQUFvQixHQUFwQixFQUFaO0FBQ0EsWUFBSyxjQUFMLENBQW9CLElBQXBCLENBQXlCLElBQXpCO0FBQ0EsWUFBSyxRQUFMO0FBQ0EsWUFBSyxTQUFMO0FBQ0Q7QUFDRixHQVJEOzs7O0FBYUEsT0FBSyxTQUFMLEdBQWlCLGtCQUFVO0FBQ3pCLFFBQU0sT0FBTyxPQUFPLE1BQXBCO0FBQUEsUUFBNEIsUUFBUSxJQUFJLEtBQUosQ0FBVSxJQUFWLENBQXBDO0FBQ0EsU0FBSyxJQUFJLElBQUksQ0FBYixFQUFnQixJQUFJLElBQXBCLEVBQTBCLEdBQTFCLEVBQStCO0FBQzdCLFlBQU0sQ0FBTixJQUFXLElBQUksS0FBSixDQUFVLElBQVYsQ0FBWDtBQUNBLFdBQUssSUFBSSxJQUFJLENBQWIsRUFBZ0IsSUFBSSxJQUFwQixFQUEwQixHQUExQixFQUErQjtBQUM3QixjQUFNLENBQU4sRUFBUyxDQUFULElBQWMsT0FBTyxNQUFQLENBQWMsRUFBZCxFQUFrQixPQUFPLENBQVAsRUFBVSxDQUFWLENBQWxCLENBQWQ7QUFDRDtBQUNGO0FBQ0QsV0FBTyxLQUFQO0FBQ0QsR0FURDs7QUFXQSxPQUFLLGNBQUwsR0FBc0Isa0JBQVU7O0FBRTlCLFFBQU0sT0FBTyxPQUFPLE1BQXBCO0FBQUEsUUFBNEIsV0FBVyxJQUFJLEtBQUosQ0FBVSxJQUFWLENBQXZDO0FBQ0EsU0FBSyxJQUFJLElBQUksQ0FBYixFQUFnQixJQUFJLElBQXBCLEVBQTBCLEdBQTFCLEVBQStCO0FBQzdCLGVBQVMsQ0FBVCxJQUFjLElBQUksS0FBSixDQUFVLElBQVYsQ0FBZDtBQUNBLFdBQUssSUFBSSxJQUFJLENBQWIsRUFBZ0IsSUFBSSxJQUFwQixFQUEwQixHQUExQixFQUErQjtBQUM3QixpQkFBUyxDQUFULEVBQVksQ0FBWixJQUFpQixPQUFPLE1BQVAsQ0FBYyxFQUFkLEVBQWtCLE9BQU8sQ0FBUCxFQUFVLE9BQU8sQ0FBUCxHQUFXLENBQXJCLENBQWxCLENBQWpCO0FBQ0Q7QUFDRjtBQUNELFdBQU8sUUFBUDtBQUNELEdBVkQ7O0FBWUEsT0FBSyxpQkFBTCxHQUF5QixrQkFBVTs7QUFFakMsUUFBTSxPQUFPLE9BQU8sTUFBcEI7QUFBQSxRQUE0QixXQUFXLElBQUksS0FBSixDQUFVLElBQVYsQ0FBdkM7QUFDQSxTQUFLLElBQUksSUFBSSxDQUFiLEVBQWdCLElBQUksSUFBcEIsRUFBMEIsR0FBMUIsRUFBK0I7QUFDN0IsZUFBUyxDQUFULElBQWMsSUFBSSxLQUFKLENBQVUsSUFBVixDQUFkO0FBQ0EsV0FBSyxJQUFJLElBQUksQ0FBYixFQUFnQixJQUFJLElBQXBCLEVBQTBCLEdBQTFCLEVBQStCO0FBQzdCLGlCQUFTLENBQVQsRUFBWSxDQUFaLElBQWlCLE9BQU8sTUFBUCxDQUFjLEVBQWQsRUFBa0IsT0FBTyxPQUFPLENBQVAsR0FBVyxDQUFsQixFQUFxQixDQUFyQixDQUFsQixDQUFqQjtBQUNEOztBQUVGO0FBQ0QsV0FBTyxRQUFQO0FBQ0QsR0FYRDs7QUFhQSxPQUFLLFdBQUwsR0FBbUIsVUFBQyxNQUFELEVBQVk7QUFDN0IsUUFBTSxPQUFPLE9BQU8sTUFBcEI7QUFDQSxZQUFRLEdBQVIsQ0FBWSxNQUFaO0FBQ0EsU0FBSyxJQUFJLElBQUksQ0FBYixFQUFnQixJQUFJLElBQXBCLEVBQTBCLEdBQTFCLEVBQStCO0FBQzdCLFVBQUksTUFBTSxFQUFWO0FBQ0EsV0FBSyxJQUFJLElBQUksQ0FBYixFQUFnQixJQUFJLElBQXBCLEVBQTBCLEdBQTFCLEVBQStCO0FBQzdCLGVBQU8sT0FBTyxDQUFQLEVBQVUsQ0FBVixFQUFhLEdBQWIsR0FBbUIsR0FBMUI7QUFDRDtBQUNELGNBQVEsR0FBUixDQUFZLEdBQVo7QUFDRDtBQUNELFlBQVEsR0FBUixDQUFZLE1BQVo7QUFDRCxHQVhEOztBQWFBLE9BQUssTUFBTCxHQUFjLFVBQUMsU0FBRCxFQUFZLE1BQVosRUFBdUI7QUFDbkMsWUFBUSxTQUFSO0FBQ0UsV0FBSyxNQUFMO0FBQ0UsZUFBTyxNQUFLLGlCQUFMLENBQXVCLE1BQUssU0FBTCxDQUFlLE1BQWYsQ0FBdkIsQ0FBUDtBQUNGLFdBQUssT0FBTDtBQUNFLGVBQU8sTUFBSyxjQUFMLENBQW9CLE1BQUssU0FBTCxDQUFlLE1BQWYsQ0FBcEIsQ0FBUDtBQUNGO0FBQ0U7QUFOSjtBQVFBLFdBQU8sTUFBUDtBQUNELEdBVkQ7O0FBWUEsT0FBSyxJQUFMLEdBQVksa0JBQVU7QUFDcEIsV0FBTyxNQUFLLGNBQUwsQ0FBb0IsTUFBSyxpQkFBTCxDQUF1QixZQUFZLE1BQVosQ0FBdkIsQ0FBcEIsQ0FBUDtBQUNELEdBRkQ7O0FBSUEsT0FBSyxlQUFMLEdBQXVCLFVBQUMsU0FBRCxFQUFZLFNBQVosRUFBMEI7QUFDL0MsWUFBUSxTQUFSO0FBQ0UsV0FBSyxNQUFMO0FBQ0UsZUFBTyxNQUFLLE1BQUwsQ0FBWSxNQUFaLEVBQW9CLFVBQVUsSUFBVixRQUFxQixNQUFLLE1BQUwsQ0FBWSxPQUFaLEVBQXFCLE1BQUssSUFBMUIsQ0FBckIsQ0FBcEIsQ0FBUDtBQUNBO0FBQ0YsV0FBSyxPQUFMO0FBQ0UsZUFBTyxNQUFLLE1BQUwsQ0FBWSxPQUFaLEVBQXFCLFVBQVUsSUFBVixRQUFxQixNQUFLLE1BQUwsQ0FBWSxNQUFaLEVBQW9CLE1BQUssSUFBekIsQ0FBckIsQ0FBckIsQ0FBUDtBQUNBO0FBQ0YsV0FBSyxJQUFMO0FBQ0UsZUFBTyxVQUFVLElBQVYsUUFBcUIsTUFBSyxJQUExQixDQUFQO0FBQ0E7QUFDRixXQUFLLE1BQUw7QUFDRSxlQUFPLE1BQUssSUFBTCxDQUFVLFVBQVUsSUFBVixRQUFxQixNQUFLLElBQUwsQ0FBVSxNQUFLLElBQWYsQ0FBckIsQ0FBVixDQUFQO0FBQ0E7QUFDRjtBQUNFLGVBQVE7QUFkWjtBQWdCRCxHQWpCRDs7QUFtQkEsT0FBSyxRQUFMLEdBQWdCLFVBQUMsTUFBRCxFQUFZO0FBQzFCLFFBQU0sT0FBTyxPQUFPLE1BQXBCO0FBQUEsUUFBNEIsWUFBWSxJQUFJLEtBQUosQ0FBVSxJQUFWLENBQXhDO0FBQ0EsU0FBSyxJQUFJLElBQUksQ0FBYixFQUFnQixJQUFJLElBQXBCLEVBQTBCLEdBQTFCLEVBQStCO0FBQzdCLGdCQUFVLENBQVYsSUFBZSxJQUFJLEtBQUosQ0FBVSxJQUFWLENBQWY7QUFDQSxXQUFLLElBQUksSUFBSSxDQUFiLEVBQWdCLElBQUksSUFBcEIsRUFBMEIsR0FBMUIsRUFBK0I7QUFDN0Isa0JBQVUsQ0FBVixFQUFhLENBQWIsSUFBa0IsWUFBWSxDQUFaLEVBQWUsQ0FBZixFQUFrQixPQUFPLENBQVAsRUFBVSxDQUFWLENBQWxCLEVBQWdDLEVBQWhDLENBQWxCO0FBQ0Q7QUFDRjtBQUNELFdBQU8sTUFBSyxXQUFMLENBQWlCLFNBQWpCLENBQVA7QUFDRCxHQVREOztBQVdBLE9BQUssV0FBTCxHQUFtQixVQUFDLE1BQUQsRUFBWTtBQUM3QixRQUFNLE9BQU8sT0FBTyxNQUFwQjtBQUFBLFFBQTRCLFlBQVksSUFBSSxLQUFKLENBQVUsSUFBVixDQUF4QztBQUNBLFNBQUssSUFBSSxJQUFJLENBQWIsRUFBZ0IsSUFBSSxJQUFwQixFQUEwQixHQUExQixFQUErQjtBQUM3QixnQkFBVSxDQUFWLElBQWUsTUFBTSxJQUFOLENBQWY7QUFDQSxXQUFLLElBQUksSUFBSSxDQUFiLEVBQWdCLElBQUksSUFBcEIsRUFBMEIsR0FBMUIsRUFBK0I7QUFDN0Isa0JBQVUsQ0FBVixFQUFhLENBQWIsSUFBa0IsT0FBTyxDQUFQLEVBQVUsQ0FBVixFQUFhLEdBQS9CO0FBQ0Q7QUFDRjtBQUNELFdBQU8sU0FBUDtBQUNELEdBVEQ7O0FBV0EsT0FBSyxXQUFMLEdBQW1CLFVBQUMsTUFBRCxFQUFZO0FBQzdCLFFBQU0sT0FBTyxPQUFPLE1BQXBCO0FBQUEsUUFBNEIsWUFBWSxJQUFJLEtBQUosQ0FBVSxJQUFWLENBQXhDO0FBQ0EsU0FBSyxJQUFJLElBQUksQ0FBYixFQUFnQixJQUFJLElBQXBCLEVBQTBCLEdBQTFCLEVBQStCO0FBQzdCLGdCQUFVLENBQVYsSUFBZSxJQUFJLEtBQUosQ0FBVSxJQUFWLENBQWY7QUFDQSxXQUFLLElBQUksSUFBSSxDQUFiLEVBQWdCLElBQUksSUFBcEIsRUFBMEIsR0FBMUIsRUFBK0I7QUFDN0Isa0JBQVUsQ0FBVixFQUFhLENBQWIsSUFBa0IsWUFBWSxDQUFaLEVBQWUsQ0FBZixFQUFrQixPQUFPLENBQVAsRUFBVSxDQUFWLEVBQWEsR0FBL0IsRUFBb0MsTUFBSyxhQUFMLENBQW1CLE1BQW5CLEVBQTJCLENBQTNCLEVBQThCLENBQTlCLENBQXBDLENBQWxCO0FBQ0Q7QUFDRjtBQUNELFdBQU8sU0FBUDtBQUNELEdBVEQ7O0FBV0EsT0FBSyxZQUFMLEdBQW9CLFVBQUMsTUFBRCxFQUFZO0FBQzlCLFFBQUksWUFBWSxDQUFoQjtBQUNBLFFBQU0sT0FBTyxPQUFPLE1BQXBCO0FBQ0EsU0FBSyxJQUFJLElBQUksQ0FBYixFQUFnQixJQUFJLElBQXBCLEVBQTBCLEdBQTFCLEVBQStCO0FBQzdCLFdBQUssSUFBSSxJQUFJLENBQWIsRUFBZ0IsSUFBSSxJQUFwQixFQUEwQixHQUExQixFQUErQjtBQUM3QixZQUFJLE9BQU8sQ0FBUCxFQUFVLENBQVYsRUFBYSxRQUFqQixFQUEyQjtBQUN6Qix1QkFBYSxPQUFPLENBQVAsRUFBVSxDQUFWLEVBQWEsR0FBMUI7QUFDRDtBQUNGO0FBQ0Y7QUFDRCxXQUFPLFNBQVA7QUFDRCxHQVhEOztBQWFBLFdBQVMsV0FBVCxDQUFzQixDQUF0QixFQUF5QixDQUF6QixFQUE0QixHQUE1QixFQUFpQyxLQUFqQyxFQUF3QztBQUN0QyxXQUFPO0FBQ0wsV0FBSyxHQURBO0FBRUwsZ0JBQVUsS0FGTDtBQUdMLGNBQVEsQ0FISDtBQUlMLGNBQVEsQ0FKSDtBQUtMLGFBQU8sQ0FMRjtBQU1MLHFCQUFlLEtBTlY7QUFPTCxhQUFPO0FBUEYsS0FBUDtBQVNEO0FBQ0QsV0FBUyxXQUFULENBQXFCLE1BQXJCLEVBQTZCO0FBQzNCLFFBQU0sT0FBTyxPQUFPLE1BQXBCO0FBQUEsUUFBNEIsWUFBWSxJQUFJLEtBQUosQ0FBVSxJQUFWLENBQXhDO0FBQ0EsU0FBSyxJQUFJLElBQUksQ0FBYixFQUFnQixJQUFJLElBQXBCLEVBQTBCLEdBQTFCLEVBQStCO0FBQzdCLGdCQUFVLENBQVYsSUFBZSxNQUFNLElBQU4sQ0FBZjtBQUNBLFdBQUssSUFBSSxJQUFJLENBQWIsRUFBZ0IsSUFBSSxJQUFwQixFQUEwQixHQUExQixFQUErQjtBQUM3QixZQUFJLFFBQU8sT0FBTyxDQUFQLEVBQVUsQ0FBVixDQUFQLEtBQXVCLFFBQTNCLEVBQ0UsVUFBVSxDQUFWLEVBQWEsQ0FBYixJQUFrQixPQUFPLE1BQVAsQ0FBYyxFQUFkLEVBQWtCLE9BQU8sQ0FBUCxFQUFVLENBQVYsQ0FBbEIsQ0FBbEI7OztBQUdIO0FBQ0Y7QUFDRCxXQUFPLFNBQVA7QUFDRDtBQUVGIiwiZmlsZSI6ImdhbWUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpZiAodHlwZW9mIE9iamVjdC5hc3NpZ24gIT0gJ2Z1bmN0aW9uJykge1xuICBPYmplY3QuYXNzaWduID0gZnVuY3Rpb24odGFyZ2V0KSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIGlmICh0YXJnZXQgPT0gbnVsbCkge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNvbnZlcnQgdW5kZWZpbmVkIG9yIG51bGwgdG8gb2JqZWN0Jyk7XG4gICAgfVxuXG4gICAgdGFyZ2V0ID0gT2JqZWN0KHRhcmdldCk7XG4gICAgZm9yIChsZXQgaW5kZXggPSAxOyBpbmRleCA8IGFyZ3VtZW50cy5sZW5ndGg7IGluZGV4KyspIHtcbiAgICAgIGNvbnN0IHNvdXJjZSA9IGFyZ3VtZW50c1tpbmRleF07XG4gICAgICBpZiAoc291cmNlICE9IG51bGwpIHtcbiAgICAgICAgZm9yIChsZXQga2V5IGluIHNvdXJjZSkge1xuICAgICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoc291cmNlLCBrZXkpKSB7XG4gICAgICAgICAgICB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGFyZ2V0O1xuICB9O1xufVxuXG5mdW5jdGlvbiBHYW1lKF9vcHRzKSB7XG5cbiAgY29uc3QgREVGQVVMVF9TSVpFID0gNDtcbiAgY29uc3QgREVGQVVMVF9HT0FMID0gMjA0ODtcbiAgY29uc3QgREVGQVVMVF9ORVdfQkxPQ0tfQ09VTlQgPSAxO1xuICBjb25zdCBORVdfQkxPQ0tfVkFMX0hJR0ggPSA0O1xuICBjb25zdCBORVdfQkxPQ0tfVkFMX0xPVyA9IDI7XG4gIGNvbnN0IEhJR0hfTE9XX1JBVElPID0gLjc1O1xuICBjb25zdCBISUdIX0JMT0NLX1BFUk1JVFRFRCA9IDEgLyAyNTY7XG5cbiAgbGV0IG9wdHMgPSBPYmplY3QuYXNzaWduKHtcbiAgICBzaXplOiBERUZBVUxUX1NJWkUsXG4gICAgZ29hbDogREVGQVVMVF9HT0FMLFxuICAgIG5ld0Jsb2NrQ291bnQ6IERFRkFVTFRfTkVXX0JMT0NLX0NPVU5ULFxuXG4gIH0sIF9vcHRzKTtcblxuICB0aGlzLmJvYXJkVW5kb1N0YWNrID0gW107XG4gIHRoaXMuYm9hcmRSZWRvU3RhY2sgPSBbXTtcbiAgdGhpcy5zY29yZSA9IDA7XG5cbiAgdGhpcy5nZXRTdGFydEJsb2NrcyA9IChibG9ja3MsIGJvYXJkU2l6ZSkgPT4ge1xuICAgIGNvbnN0IGxvYyA9IFtNYXRoLmZsb29yKGJvYXJkU2l6ZSAqIE1hdGgucmFuZG9tKCkpLCBNYXRoLmZsb29yKGJvYXJkU2l6ZSAqIE1hdGgucmFuZG9tKCkpXTtcbiAgICBpZiAoIWJsb2Nrcy5zb21lKGIgPT4gYlswXSA9PSBsb2NbMF0gJiYgYlsxXSA9PSBsb2NbMV0pKSB7XG4gICAgICBibG9ja3MucHVzaChsb2MpO1xuICAgICAgcmV0dXJuIGJsb2NrcztcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0U3RhcnRCbG9ja3MoYmxvY2tzLCBib2FyZFNpemUpO1xuICAgIH1cbiAgfTtcblxuICB0aGlzLmdhbWVTdGF0dXMgPSAoKSA9PiB7XG4gICAgcmV0dXJuIHRoaXMuc3RhdHVzO1xuICB9O1xuXG4gIHRoaXMuZ2V0TmV3QmxvY2tzID0gKG1hdHJpeCwgY291bnQsIG5ld0Jsb2NrcykgPT4ge1xuICAgIGlmICgwID09IGNvdW50LS0pIHJldHVybiBuZXdCbG9ja3M7XG4gICAgY29uc3QgYm9hcmRTaXplID0gbWF0cml4Lmxlbmd0aCwgYXZhaWxhYmxlID0gW107XG4gICAgY29uc3QgbmV3TWF0cml4ID0gY2xvbmVNYXRyaXgobWF0cml4KTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJvYXJkU2l6ZTsgaSsrKSB7XG4gICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGJvYXJkU2l6ZTsgaisrKSB7XG4gICAgICAgIGlmICghbWF0cml4W2ldW2pdLnZhbCkgYXZhaWxhYmxlLnB1c2goe3k6IGksIHg6IGp9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoIWF2YWlsYWJsZS5sZW5ndGgpIHJldHVybiBuZXdCbG9ja3M7XG5cbiAgICBjb25zdCBjID0gYXZhaWxhYmxlW01hdGguZmxvb3IoYXZhaWxhYmxlLmxlbmd0aCAqIE1hdGgucmFuZG9tKCkpXTtcbiAgICBuZXdCbG9ja3MucHVzaChjKTtcbiAgICBuZXdNYXRyaXhbYy55XVtjLnhdLnZhbCA9IDI7XG4gICAgcmV0dXJuIHRoaXMuZ2V0TmV3QmxvY2tzKG5ld01hdHJpeCwgY291bnQsIG5ld0Jsb2Nrcyk7XG4gIH07XG5cbiAgdGhpcy5tYXliZUdldEJsb2NrID0gKGJsb2NrcywgeCwgeSkgPT4ge1xuICAgIGNvbnN0IHZhbCA9IGJsb2Nrcy5zb21lKGIgPT4gYlswXSA9PSB4ICYmIGJbMV0gPT0geSkgPyAyIDogMDtcbiAgICByZXR1cm4geyB2YWwsIGNvbWJpbmVkOiBmYWxzZSwgc3RhcnRZOiB5LCBzdGFydFg6IHgsIG1vdmVkOiAwIH07XG4gIH07XG5cbiAgdGhpcy5uZXdHYW1lID0gKG5ld09wdHMpID0+IHtcbiAgICB0aGlzLnN0YXR1cyA9ICdhY3RpdmUnO1xuICAgIG9wdHMgPSBPYmplY3QuYXNzaWduKHt9LCBvcHRzLCBuZXdPcHRzKTtcbiAgICB0aGlzLmJvYXJkU2l6ZSA9IG9wdHMuc2l6ZTtcbiAgICB0aGlzLm1heEJsb2NrVmFsdWUgPSAyO1xuXG4gICAgbGV0IGdhbWVCbG9ja3MgPSB0aGlzLmdldFN0YXJ0QmxvY2tzKFtdLCB0aGlzLmJvYXJkU2l6ZSk7XG4gICAgZ2FtZUJsb2NrcyA9IHRoaXMuZ2V0U3RhcnRCbG9ja3MoZ2FtZUJsb2NrcywgdGhpcy5ib2FyZFNpemUpO1xuXG4gICAgdGhpcy5yb3dzID0gW107XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmJvYXJkU2l6ZTsgaSsrKSB7XG4gICAgICBjb25zdCByb3cgPSBbXTtcbiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5ib2FyZFNpemU7IGorKykge1xuICAgICAgICByb3cucHVzaCh0aGlzLm1heWJlR2V0QmxvY2soZ2FtZUJsb2NrcywgaSwgaikpO1xuICAgICAgfVxuICAgICAgdGhpcy5yb3dzLnB1c2gocm93KTtcbiAgICB9XG4gICAgdGhpcy5yb3dzID0gdGhpcy51cGRhdGVQcm9wcyh0aGlzLnJvd3MpO1xuICB9O1xuXG4gIHRoaXMuY29tYmluZVZhbHVlc1VwID0gKG1hdHJpeCwgc2Vjb25kUGFzcykgPT4ge1xuICAgIGNvbnN0IHNpemUgPSBtYXRyaXgubGVuZ3RoLCBjb21iaW5lZCA9IGNsb25lTWF0cml4KG1hdHJpeCk7XG5cbiAgICBmb3IgKGxldCB4ID0gMDsgeCA8IHNpemU7IHgrKykge1xuICAgICAgbGV0IHNpemVfciA9IHNpemU7XG4gICAgICBmb3IgKGxldCB5ID0gMDsgeSA8IHNpemVfciAtIDE7IHkrKykge1xuICAgICAgICBsZXQgY3VyQmxvY2sgPSBjb21iaW5lZFt5XVt4XSxcbiAgICAgICAgICBuZXh0QmxvY2sgPSBjb21iaW5lZFt5ICsgMV1beF07XG5cbiAgICAgICAgaWYgKGN1ckJsb2NrLnZhbCA9PT0gMCkge1xuICAgICAgICAgIGxldCB5MTtcbiAgICAgICAgICBmb3IgKHkxID0geTsgeTEgPCBzaXplX3IgLSAxOyB5MSsrKSB7XG4gICAgICAgICAgICBjb21iaW5lZFt5MV1beF0gPSBPYmplY3QuYXNzaWduKHt9LCBjb21iaW5lZFt5MSArIDFdW3hdKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29tYmluZWRbeTFdW3hdLnZhbCA9IDA7XG4gICAgICAgICAgeS0tOyBzaXplX3ItLTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAoY3VyQmxvY2sudmFsID09PSBuZXh0QmxvY2sudmFsICYmICFjdXJCbG9jay5jb21iaW5lZCAmJiAhbmV4dEJsb2NrLmNvbWJpbmVkKSB7XG4gICAgICAgICAgICBsZXQgeTE7XG4gICAgICAgICAgICBjb25zdCBuZXdWYWx1ZSA9IGN1ckJsb2NrLnZhbCAqIDI7XG4gICAgICAgICAgICAvL3RoaXMuc2NvcmUgKz0gbmV3VmFsdWU7XG5cbiAgICAgICAgICAgIGNvbWJpbmVkW3ldW3hdID0gT2JqZWN0LmFzc2lnbih7fSwgbmV4dEJsb2NrLCB7IGNvbWJpbmVkOiB7IHk6IGN1ckJsb2NrLnN0YXJ0WSwgeDogY3VyQmxvY2suc3RhcnRYIH0sIHZhbDogbmV3VmFsdWV9KTtcbiAgICAgICAgICAgIG5leHRCbG9jay52YWwgPSAwO1xuICAgICAgICAgICAgZm9yICh5MSA9IHkrMTsgeTEgPCBzaXplX3IgLSAxOyB5MSsrKSB7XG4gICAgICAgICAgICAgIGNvbWJpbmVkW3kxXVt4XSA9IE9iamVjdC5hc3NpZ24oeyB9LCBjb21iaW5lZFt5MSArIDFdW3hdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbWJpbmVkW3kxXVt4XS52YWwgPSAwO1xuICAgICAgICAgICAgeS0tOyBzaXplX3ItLTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoIXNlY29uZFBhc3MpIHtcbiAgICAgIHJldHVybiB0aGlzLmNvbWJpbmVWYWx1ZXNVcChjb21iaW5lZCwgdHJ1ZSk7XG4gICAgfVxuICAgIHJldHVybiBjb21iaW5lZDtcbiAgfTtcblxuICB0aGlzLmdldEJsb2NrTW92ZW1lbnRzID0gZGlyZWN0aW9uID0+IHtcbiAgICBjb25zdCBzaXplID0gdGhpcy5yb3dzLmxlbmd0aCwgYmxvY2tzID0gW107XG5cbiAgICBjb25zdCBwcmV2aWV3ID0gdGhpcy5tb3ZlQmxvY2tzKGRpcmVjdGlvbik7XG5cbiAgICBmb3IgKGxldCB5ID0gMDsgeSA8IHNpemU7IHkrKykge1xuICAgICAgYmxvY2tzLnB1c2gobmV3IEFycmF5KHNpemUpKTtcbiAgICAgIGZvciAobGV0IHggPSAwOyB4IDwgc2l6ZTsgeCsrKSB7XG4gICAgICAgIGJsb2Nrc1t5XVt4XSA9IDA7XG4gICAgICB9XG4gICAgfVxuICAgIGZvciAobGV0IHkgPSAwOyB5IDwgc2l6ZTsgeSsrKSB7XG4gICAgICBmb3IgKGxldCB4ID0gMDsgeCA8IHNpemU7IHgrKykge1xuICAgICAgICAvLyAgbGV0IGJsb2NrID0gdGhpcy5yb3dzW3ldW3hdO1xuICAgICAgICBsZXQgbmV3QmxvY2sgPSBwcmV2aWV3W3ldW3hdO1xuXG4gICAgICAgIGxldCBkeCA9IDAsIGR5ID0gMDtcblxuICAgICAgICBzd2l0Y2ggKGRpcmVjdGlvbikge1xuICAgICAgICAgIGNhc2UgJ3VwJzpcbiAgICAgICAgICBjYXNlICdkb3duJzpcbiAgICAgICAgICAgIGR5ID0geSAtIG5ld0Jsb2NrLnN0YXJ0WTsgYnJlYWs7XG4gICAgICAgICAgY2FzZSAnbGVmdCc6XG4gICAgICAgICAgY2FzZSAncmlnaHQnOlxuICAgICAgICAgICAgZHggPSB4IC0gbmV3QmxvY2suc3RhcnRYIDsgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgLy9jb25zb2xlLmxvZyh5LHgsZHksZHgsbixibG9jayxuZXdCbG9jaylcblxuICAgICAgICBpZiAoKGR5IHx8IGR4KSAgJiYgbmV3QmxvY2sudmFsKVxuICAgICAgICAgIGJsb2Nrc1tuZXdCbG9jay5zdGFydFldW25ld0Jsb2NrLnN0YXJ0WF0gPSB7IGR5LCBkeCB9O1xuXG4gICAgICAgIGlmIChuZXdCbG9jay5jb21iaW5lZCkge1xuICAgICAgICAgIGxldCBkeCA9IDAsIGR5ID0gMDtcbiAgICAgICAgICBzd2l0Y2ggKGRpcmVjdGlvbikge1xuICAgICAgICAgICAgY2FzZSAndXAnOlxuICAgICAgICAgICAgY2FzZSAnZG93bic6XG4gICAgICAgICAgICAgIGR5ID0geSAtIG5ld0Jsb2NrLmNvbWJpbmVkLnk7IGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnbGVmdCc6XG4gICAgICAgICAgICBjYXNlICdyaWdodCc6XG4gICAgICAgICAgICAgIGR4ID0geCAtIG5ld0Jsb2NrLmNvbWJpbmVkLnggOyBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgLy9jb25zb2xlLmxvZyh5LHgsZHksZHgsbmV3QmxvY2suY29tYmluZWQpXG5cbiAgICAgICAgICBpZiAoKGR5IHx8IGR4KSAgJiYgbmV3QmxvY2sudmFsKVxuICAgICAgICAgICAgYmxvY2tzW25ld0Jsb2NrLmNvbWJpbmVkLnldW25ld0Jsb2NrLmNvbWJpbmVkLnhdID0geyBkeSwgZHgsIHJlbW92ZWQ6IHRydWUgfTtcbiAgICAgICAgICAgIGJsb2Nrc1t5XVt4XSA9IE9iamVjdC5hc3NpZ24oeyBjb21iaW5lZDogdHJ1ZSB9LCBibG9ja3NbeV1beF0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGJsb2NrcztcbiAgfTtcblxuICB0aGlzLnBvc3NpYmxlTW92ZXMgPSAobWF0cml4LCB5LCB4KSAgPT4ge1xuICAgIGNvbnN0IHNpemUgPSB0aGlzLnJvd3MubGVuZ3RoLCBtb3ZlcyA9IFtdO1xuICAgIGNvbnN0IG5icyA9IFtbLTEsIDAsICd1cCddLCBbMCwgLTEsICdsZWZ0J10sIFswLCAxLCAncmlnaHQnXSwgWzEsIDAsICdkb3duJ11dO1xuICAgIGZvciAobGV0IGo9MDsgajxuYnMubGVuZ3RoOyBqKyspIHtcbiAgICAgIGNvbnN0IHkxID0geSArIG5ic1tqXVswXSwgeDEgPSB4ICsgbmJzW2pdWzFdO1xuICAgICAgaWYgKHgxID49IDAgJiYgeTEgPj0gMCAmJiB4MSA8IHNpemUgJiYgeTEgPCBzaXplKSB7XG4gICAgICAgIGlmIChtYXRyaXhbeV1beF0udmFsICYmIChtYXRyaXhbeTFdW3gxXS52YWwgPT0gbWF0cml4W3ldW3hdLnZhbCB8fCAhbWF0cml4W3kxXVt4MV0udmFsKSlcbiAgICAgICAgICBtb3Zlcy5wdXNoKG5ic1tqXVsyXSk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBtb3ZlcztcbiAgfTtcblxuXG4gIHRoaXMuZ2V0TmV3QmxvY2tWYWx1ZSA9IChub3RSYW5kb20pID0+ICh0aGlzLm1heEJsb2NrVmFsdWUgPj0gb3B0cy5nb2FsICogSElHSF9CTE9DS19QRVJNSVRURUQgJiYgKG5vdFJhbmRvbSB8fCBNYXRoLnJhbmRvbSgpID4gSElHSF9MT1dfUkFUSU8pKSA/IE5FV19CTE9DS19WQUxfSElHSDogTkVXX0JMT0NLX1ZBTF9MT1c7XG5cbiAgdGhpcy5wcm9jZXNzTW92ZSA9IGRpcmVjdGlvbiA9PiB7XG5cbiAgICBjb25zdCBzaXplID0gdGhpcy5yb3dzLmxlbmd0aCwgbW92ZXMgPSBbXTtcblxuICAgIGlmICh0aGlzLnN0YXR1cyAhPT0gJ2FjdGl2ZScpXG4gICAgICByZXR1cm47XG5cbiAgICBmb3IgKGxldCB5ID0gMDsgeSA8IHNpemU7IHkrKykge1xuICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCBzaXplOyB4KyspIHtcbiAgICAgICAgaWYgKHRoaXMucm93c1t5XVt4XS5wb3NzaWJsZU1vdmVzLmxlbmd0aClcbiAgICAgICAgbW92ZXMucHVzaCh0aGlzLnJvd3NbeV1beF0ucG9zc2libGVNb3Zlcyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCFtb3Zlcy5zb21lKGIgPT4gYi5zb21lKG0gPT4gbSA9PT0gZGlyZWN0aW9uKSkpXG4gICAgICByZXR1cm47XG5cbiAgICB0aGlzLmJvYXJkVW5kb1N0YWNrLnB1c2goIHRoaXMucm93cyApO1xuICAgIHRoaXMuYm9hcmRSZWRvU3RhY2sgPSBbXTtcblxuICAgIHRoaXMucm93cyA9IHRoaXMubW92ZUJsb2NrcyhkaXJlY3Rpb24pO1xuXG4gICAgaWYgKHRoaXMuY2hlY2tXaW4oKSkgcmV0dXJuO1xuXG4gICAgdGhpcy5uZXdCbG9ja3MgPSB0aGlzLmdldE5ld0Jsb2Nrcyh0aGlzLnJvd3MsIG9wdHMubmV3QmxvY2tDb3VudCwgW10pO1xuICAgIGNvbnN0IG5ld1ZhbCA9IHRoaXMuZ2V0TmV3QmxvY2tWYWx1ZSgpO1xuICAgIHRoaXMubmV3QmxvY2tzLmZvckVhY2goYyA9PiB7XG4gICAgICBPYmplY3QuYXNzaWduKHRoaXMucm93c1tjLnldW2MueF0sIGdldERlZmF1bHRzKGMueSwgYy54LCBuZXdWYWwsIG51bGwpLCB7IGlzTmV3OiB0cnVlIH0pO1xuXG4gICAgfSk7XG4gICAgXG4gICAgdGhpcy5zY29yZSArPSB0aGlzLmdldE1vdmVTY29yZSh0aGlzLnJvd3MpO1xuXG4gICAgdGhpcy5yb3dzID0gdGhpcy51cGRhdGVQcm9wcyh0aGlzLnJvd3MpO1xuXG4gICAgdGhpcy5jaGVja0xvc3MoKTtcblxuICB9O1xuXG4gIHRoaXMuY2hlY2tXaW4gPSAoKSA9PiB7XG4gICAgY29uc3Qgc2l6ZSA9IHRoaXMucm93cy5sZW5ndGg7XG4gICAgZm9yIChsZXQgeSA9IDA7IHkgPCBzaXplOyB5KyspIHtcbiAgICAgIGZvciAobGV0IHggPSAwOyB4IDwgc2l6ZTsgeCsrKSB7XG4gICAgICAgIGlmICh0aGlzLnJvd3NbeV1beF0udmFsID49IHRoaXMubWF4QmxvY2tWYWx1ZSkge1xuICAgICAgICAgIHRoaXMubWF4QmxvY2tWYWx1ZSA9IHRoaXMucm93c1t5XVt4XS52YWw7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodGhpcy5tYXhCbG9ja1ZhbHVlID49IG9wdHMuZ29hbCkge1xuICAgICAgdGhpcy5zdGF0dXMgPSAnd2luJztcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuICB0aGlzLmNoZWNrTG9zcyA9ICgpID0+IHtcbiAgICBjb25zdCBzaXplID0gdGhpcy5yb3dzLmxlbmd0aCwgbW92ZXMgPSBbXTtcbiAgICBmb3IgKGxldCB5ID0gMDsgeSA8IHNpemU7IHkrKykge1xuICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCBzaXplOyB4KyspIHtcbiAgICAgICAgbW92ZXMucHVzaCh0aGlzLnJvd3NbeV1beF0ucG9zc2libGVNb3Zlcyk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmICghbW92ZXMuc29tZShiID0+IGIubGVuZ3RoICE9IDApKSB7XG4gICAgICB0aGlzLnN0YXR1cyA9ICdsb3NzJzsgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuXG4gIHRoaXMubW92ZUJsb2NrcyA9IGRpcmVjdGlvbiA9PiB0aGlzLnRyYW5zZm9ybU1hdHJpeChkaXJlY3Rpb24sIHRoaXMuY29tYmluZVZhbHVlc1VwKTtcblxuICB0aGlzLnVuZG8gPSAoKSA9PiB7XG4gICAgaWYgKHRoaXMuYm9hcmRVbmRvU3RhY2subGVuZ3RoKSB7XG4gICAgICB0aGlzLnN0YXR1cyA9ICdhY3RpdmUnO1xuICAgICAgY29uc3QgcmVkbyA9IHRoaXMucm93cztcbiAgICAgIHRoaXMucm93cyA9IHRoaXMuYm9hcmRVbmRvU3RhY2sucG9wKCk7XG4gICAgICB0aGlzLmJvYXJkUmVkb1N0YWNrLnB1c2gocmVkbyk7XG4gICAgfVxuICB9O1xuXG4gIHRoaXMucmVkbyA9ICgpID0+IHtcbiAgICBpZiAodGhpcy5ib2FyZFJlZG9TdGFjay5sZW5ndGgpIHtcbiAgICAgIGNvbnN0IHVuZG8gPSB0aGlzLnJvd3M7XG4gICAgICB0aGlzLnJvd3MgPSB0aGlzLmJvYXJkUmVkb1N0YWNrLnBvcCgpO1xuICAgICAgdGhpcy5ib2FyZFVuZG9TdGFjay5wdXNoKHVuZG8pO1xuICAgICAgdGhpcy5jaGVja1dpbigpO1xuICAgICAgdGhpcy5jaGVja0xvc3MoKTtcbiAgICB9XG4gIH07XG5cblxuICAvLyBtYXRyaXggaGVscGVyc1xuXG4gIHRoaXMudHJhbnNwb3NlID0gbWF0cml4ID0+IHtcbiAgICBjb25zdCBzaXplID0gbWF0cml4Lmxlbmd0aCwgdHJhbnMgPSBuZXcgQXJyYXkoc2l6ZSk7XG4gICAgZm9yIChsZXQgeSA9IDA7IHkgPCBzaXplOyB5KyspIHtcbiAgICAgIHRyYW5zW3ldID0gbmV3IEFycmF5KHNpemUpO1xuICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCBzaXplOyB4KyspIHtcbiAgICAgICAgdHJhbnNbeV1beF0gPSBPYmplY3QuYXNzaWduKHt9LCBtYXRyaXhbeF1beV0pO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdHJhbnM7XG4gIH07XG5cbiAgdGhpcy5yZXZlcnNlRWFjaFJvdyA9IG1hdHJpeCA9PiB7XG5cbiAgICBjb25zdCBzaXplID0gbWF0cml4Lmxlbmd0aCwgcmV2ZXJzZWQgPSBuZXcgQXJyYXkoc2l6ZSk7XG4gICAgZm9yIChsZXQgeSA9IDA7IHkgPCBzaXplOyB5KyspIHtcbiAgICAgIHJldmVyc2VkW3ldID0gbmV3IEFycmF5KHNpemUpO1xuICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCBzaXplOyB4KyspIHtcbiAgICAgICAgcmV2ZXJzZWRbeV1beF0gPSBPYmplY3QuYXNzaWduKHt9LCBtYXRyaXhbeV1bc2l6ZSAtIHggLSAxXSk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXZlcnNlZDtcbiAgfTtcblxuICB0aGlzLnJldmVyc2VFYWNoQ29sdW1uID0gbWF0cml4ID0+IHtcblxuICAgIGNvbnN0IHNpemUgPSBtYXRyaXgubGVuZ3RoLCByZXZlcnNlZCA9IG5ldyBBcnJheShzaXplKTtcbiAgICBmb3IgKGxldCB5ID0gMDsgeSA8IHNpemU7IHkrKykge1xuICAgICAgcmV2ZXJzZWRbeV0gPSBuZXcgQXJyYXkoc2l6ZSk7XG4gICAgICBmb3IgKGxldCB4ID0gMDsgeCA8IHNpemU7IHgrKykge1xuICAgICAgICByZXZlcnNlZFt5XVt4XSA9IE9iamVjdC5hc3NpZ24oe30sIG1hdHJpeFtzaXplIC0geSAtIDFdW3hdKTtcbiAgICAgIH1cbiAgICAgIC8vcmV2ZXJzZWRbeV0gPSBPYmplY3QuYXNzaWduKHt9LCBtYXRyaXhbc2l6ZSAtIHkgLSAxXSk7XG4gICAgfVxuICAgIHJldHVybiByZXZlcnNlZDtcbiAgfTtcblxuICB0aGlzLnByaW50TWF0cml4ID0gKG1hdHJpeCkgPT4ge1xuICAgIGNvbnN0IHNpemUgPSBtYXRyaXgubGVuZ3RoO1xuICAgIGNvbnNvbGUubG9nKCctLS0tJyk7XG4gICAgZm9yIChsZXQgeSA9IDA7IHkgPCBzaXplOyB5KyspIHtcbiAgICAgIGxldCByb3cgPSAnJztcbiAgICAgIGZvciAobGV0IHggPSAwOyB4IDwgc2l6ZTsgeCsrKSB7XG4gICAgICAgIHJvdyArPSBtYXRyaXhbeV1beF0udmFsICsgJyAnO1xuICAgICAgfVxuICAgICAgY29uc29sZS5sb2cocm93KTtcbiAgICB9XG4gICAgY29uc29sZS5sb2coJy0tLS0nKTtcbiAgfTtcblxuICB0aGlzLnJvdGF0ZSA9IChkaXJlY3Rpb24sIG1hdHJpeCkgPT4ge1xuICAgIHN3aXRjaCAoZGlyZWN0aW9uKSB7XG4gICAgICBjYXNlICdsZWZ0JzpcbiAgICAgICAgcmV0dXJuIHRoaXMucmV2ZXJzZUVhY2hDb2x1bW4odGhpcy50cmFuc3Bvc2UobWF0cml4KSk7XG4gICAgICBjYXNlICdyaWdodCc6XG4gICAgICAgIHJldHVybiB0aGlzLnJldmVyc2VFYWNoUm93KHRoaXMudHJhbnNwb3NlKG1hdHJpeCkpO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICAgIHJldHVybiBtYXRyaXg7XG4gIH07XG5cbiAgdGhpcy5mbGlwID0gbWF0cml4ID0+IHtcbiAgICByZXR1cm4gdGhpcy5yZXZlcnNlRWFjaFJvdyh0aGlzLnJldmVyc2VFYWNoQ29sdW1uKGNsb25lTWF0cml4KG1hdHJpeCkpKTtcbiAgfTtcblxuICB0aGlzLnRyYW5zZm9ybU1hdHJpeCA9IChkaXJlY3Rpb24sIGNvbWJpbmVGbikgPT4ge1xuICAgIHN3aXRjaCAoZGlyZWN0aW9uKSB7XG4gICAgICBjYXNlICdsZWZ0JzpcbiAgICAgICAgcmV0dXJuIHRoaXMucm90YXRlKCdsZWZ0JywgY29tYmluZUZuLmNhbGwodGhpcywgdGhpcy5yb3RhdGUoJ3JpZ2h0JywgdGhpcy5yb3dzKSkpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3JpZ2h0JzpcbiAgICAgICAgcmV0dXJuIHRoaXMucm90YXRlKCdyaWdodCcsIGNvbWJpbmVGbi5jYWxsKHRoaXMsIHRoaXMucm90YXRlKCdsZWZ0JywgdGhpcy5yb3dzKSkpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3VwJzpcbiAgICAgICAgcmV0dXJuIGNvbWJpbmVGbi5jYWxsKHRoaXMsIHRoaXMucm93cyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnZG93bic6XG4gICAgICAgIHJldHVybiB0aGlzLmZsaXAoY29tYmluZUZuLmNhbGwodGhpcywgdGhpcy5mbGlwKHRoaXMucm93cykpKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm47IGJyZWFrO1xuICAgIH1cbiAgfTtcblxuICB0aGlzLmFkZFByb3BzID0gKG1hdHJpeCkgPT4ge1xuICAgIGNvbnN0IHNpemUgPSBtYXRyaXgubGVuZ3RoLCBuZXdNYXRyaXggPSBuZXcgQXJyYXkoc2l6ZSk7XG4gICAgZm9yIChsZXQgeSA9IDA7IHkgPCBzaXplOyB5KyspIHtcbiAgICAgIG5ld01hdHJpeFt5XSA9IG5ldyBBcnJheShzaXplKTtcbiAgICAgIGZvciAobGV0IHggPSAwOyB4IDwgc2l6ZTsgeCsrKSB7XG4gICAgICAgIG5ld01hdHJpeFt5XVt4XSA9IGdldERlZmF1bHRzKHksIHgsIG1hdHJpeFt5XVt4XSwgW10pO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGhpcy51cGRhdGVQcm9wcyhuZXdNYXRyaXgpO1xuICB9O1xuXG4gIHRoaXMucmVtb3ZlUHJvcHMgPSAobWF0cml4KSA9PiB7XG4gICAgY29uc3Qgc2l6ZSA9IG1hdHJpeC5sZW5ndGgsIG5ld01hdHJpeCA9IG5ldyBBcnJheShzaXplKTtcbiAgICBmb3IgKGxldCB5ID0gMDsgeSA8IHNpemU7IHkrKykge1xuICAgICAgbmV3TWF0cml4W3ldID0gQXJyYXkoc2l6ZSk7XG4gICAgICBmb3IgKGxldCB4ID0gMDsgeCA8IHNpemU7IHgrKykge1xuICAgICAgICBuZXdNYXRyaXhbeV1beF0gPSBtYXRyaXhbeV1beF0udmFsO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbmV3TWF0cml4O1xuICB9O1xuXG4gIHRoaXMudXBkYXRlUHJvcHMgPSAobWF0cml4KSA9PiB7XG4gICAgY29uc3Qgc2l6ZSA9IG1hdHJpeC5sZW5ndGgsIG5ld01hdHJpeCA9IG5ldyBBcnJheShzaXplKTtcbiAgICBmb3IgKGxldCB5ID0gMDsgeSA8IHNpemU7IHkrKykge1xuICAgICAgbmV3TWF0cml4W3ldID0gbmV3IEFycmF5KHNpemUpO1xuICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCBzaXplOyB4KyspIHtcbiAgICAgICAgbmV3TWF0cml4W3ldW3hdID0gZ2V0RGVmYXVsdHMoeSwgeCwgbWF0cml4W3ldW3hdLnZhbCwgdGhpcy5wb3NzaWJsZU1vdmVzKG1hdHJpeCwgeSwgeCkpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbmV3TWF0cml4O1xuICB9O1xuXG4gIHRoaXMuZ2V0TW92ZVNjb3JlID0gKG1hdHJpeCkgPT4ge1xuICAgIGxldCBtb3ZlU2NvcmUgPSAwO1xuICAgIGNvbnN0IHNpemUgPSBtYXRyaXgubGVuZ3RoO1xuICAgIGZvciAobGV0IHkgPSAwOyB5IDwgc2l6ZTsgeSsrKSB7XG4gICAgICBmb3IgKGxldCB4ID0gMDsgeCA8IHNpemU7IHgrKykge1xuICAgICAgICBpZiAobWF0cml4W3ldW3hdLmNvbWJpbmVkKSB7XG4gICAgICAgICAgbW92ZVNjb3JlICs9IG1hdHJpeFt5XVt4XS52YWw7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG1vdmVTY29yZTtcbiAgfTtcblxuICBmdW5jdGlvbiBnZXREZWZhdWx0cyAoeSwgeCwgdmFsLCBtb3Zlcykge1xuICAgIHJldHVybiB7XG4gICAgICB2YWw6IHZhbCxcbiAgICAgIGNvbWJpbmVkOiBmYWxzZSxcbiAgICAgIHN0YXJ0WTogeSxcbiAgICAgIHN0YXJ0WDogeCxcbiAgICAgIG1vdmVkOiAwLFxuICAgICAgcG9zc2libGVNb3ZlczogbW92ZXMsXG4gICAgICBpc05ldzogZmFsc2VcbiAgICB9XG4gIH1cbiAgZnVuY3Rpb24gY2xvbmVNYXRyaXgobWF0cml4KSB7XG4gICAgY29uc3Qgc2l6ZSA9IG1hdHJpeC5sZW5ndGgsIG5ld01hdHJpeCA9IG5ldyBBcnJheShzaXplKTtcbiAgICBmb3IgKGxldCB5ID0gMDsgeSA8IHNpemU7IHkrKykge1xuICAgICAgbmV3TWF0cml4W3ldID0gQXJyYXkoc2l6ZSk7XG4gICAgICBmb3IgKGxldCB4ID0gMDsgeCA8IHNpemU7IHgrKykge1xuICAgICAgICBpZiAodHlwZW9mIG1hdHJpeFt5XVt4XSA9PSAnb2JqZWN0JylcbiAgICAgICAgICBuZXdNYXRyaXhbeV1beF0gPSBPYmplY3QuYXNzaWduKHt9LCBtYXRyaXhbeV1beF0pO1xuICAgICAgICAvL2Vsc2VcbiAgICAgICAgLy9uZXdNYXRyaXhbeV1beF0gPSBtYXRyaXhbeV1beF07XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBuZXdNYXRyaXg7XG4gIH1cblxufVxuXG4iXX0=
'use strict';

riot.tag2('app', '<header> <div class="controls"> <button type="button" name="button" id="newGame" onclick="{newGame}">New Game</button> <div class="sizeWrapper"> <button type="button" name="button" id="setSize" onclick="{showSizeDropdown}">Size: {boardSize} &#9660; </button> <size if="{settingSize()}"></size> </div> <div class="undoWrapper"> <button id="undo" onclick="{undoClick}">Undo</button> <button id="redo" onclick="{redoClick}">Redo</button> </div> </div> <score></score> </header> <winlose if="{gameStatus == \'win\'}">YOU WIN</winlose> <winlose if="{gameStatus == \'loss\'}">YOU LOSE</winlose> <board name="board" game="{game}"></board> <div class="status"> Game status: <input onkeydown="{handleKeyDown}" onkeypress="{handleKeyPress}" onclick="{updateGame}" id="input" name="test" value="{gameStatus}" readonly> </div>', '', 'onclick="{setFocus}"', function (opts) {
  var _this = this;

  var DRAG_ENABLED = false;

  this.boardSize = 4;

  this.game = new Game({
    size: this.boardSize
  });

  this.game.newGame();

  this.gameScore = 0;

  this.settingBoardSize = false;

  this.isTouchEnabled = "ontouchstart" in document.documentElement;

  this.on('mount', function () {

    setTimeout(_this.setFocus, 300);

    document.documentElement.className += _this.isTouchEnabled ? ' touch' : ' no-touch';

    var mc = new Hammer.Manager(_this.board);

    var swipe = new Hammer.Swipe({
      threshold: 20
    });

    if (DRAG_ENABLED) {
      var pan = new Hammer.Pan({
        threshold: 5
      });
      pan.recognizeWith(swipe);
      mc.add(pan);
      mc.get('pan').set({ direction: Hammer.DIRECTION_ALL });

      mc.on("pan", function (ev) {
        var dir = void 0,
            axis = void 0;

        switch (ev.direction) {
          case Hammer.DIRECTION_LEFT:
            dir = 'left';axis = 'x';break;
          case Hammer.DIRECTION_RIGHT:
            dir = 'right';axis = 'x';break;
          case Hammer.DIRECTION_UP:
            dir = 'up';axis = 'y';break;
          case Hammer.DIRECTION_DOWN:
            dir = 'down';axis = 'y';break;
        }

        vent.trigger('drag', dir, axis === 'x' ? ev.deltaX : 0, axis === 'y' ? ev.deltaY : 0);
      });

      mc.on("panstart1", function (ev) {
        var START_X = 0,
            START_Y = 0;
        var dir = void 0;

        switch (ev.direction) {
          case Hammer.DIRECTION_LEFT:
            dir = 'left';break;
          case Hammer.DIRECTION_RIGHT:
            dir = 'right';break;
          case Hammer.DIRECTION_UP:
            dir = 'up';break;
          case Hammer.DIRECTION_DOWN:
            dir = 'down';break;
        }
      });
    }

    mc.add(swipe);

    mc.on('swipe', function (e) {
      var dir = void 0;
      switch (e.direction) {
        case Hammer.DIRECTION_LEFT:
          dir = 'left';break;
        case Hammer.DIRECTION_RIGHT:
          dir = 'right';break;
        case Hammer.DIRECTION_UP:
          dir = 'up';break;
        case Hammer.DIRECTION_DOWN:
          dir = 'down';break;
      }
      _this.sendMove(dir);
    });
  });

  this.handleKeyDown = function (e) {

    e.preventUpdate = true;
    var keys = {
      37: 'left',
      38: 'up',
      39: 'right',
      40: 'down'
    };
    this.sendMove(keys[e.keyCode]);
  }.bind(this);

  this.sendMove = function (dir) {
    if (!dir) return true;
    this.lastMoveDirection = dir;
    this.trigger('move', dir);
  }.bind(this);

  this.newGame = function (e) {
    this.game.newGame({
      size: this.boardSize
    });
    this.trigger('newgame');
    this.gameStatus = 'active';
    this.gameScore = 0;
    this.updateGame();
  }.bind(this);

  this.setFocus = function (e) {
    if (this.isTouchEnabled) return;

    this.input.focus();
    if (e) e.preventUpdate = true;
  }.bind(this);

  this.updateGame = function (e) {
    this.update();
  }.bind(this);

  this.undoClick = function () {
    this.game.undo();
    this.trigger('move moved');
  }.bind(this);

  this.redoClick = function () {
    this.game.redo();
    this.trigger('move moved');
  }.bind(this);

  this.on('moved', function () {
    _this.gameStatus = _this.game.gameStatus();
    _this.gameScore = _this.game.score;
    _this.update();
  });

  this.handleKeyPress = function (e) {
    if (!(e.ctrlKey || e.metaKey || e.altKey)) {
      e.stopPropagation();
      e.preventDefault();
    }
  }.bind(this);

  this.getMovingClass = function () {
    return "moving-" + this.lastMoveDirection;
  }.bind(this);

  this.settingSize = function () {
    return this.settingBoardSize;
  }.bind(this);

  this.setBoardSize = function (val) {
    this.settingBoardSize = false;
    this.boardSize = val;
    this.update();
  }.bind(this);

  this.showSizeDropdown = function () {
    this.settingBoardSize = !this.settingBoardSize;
  }.bind(this);
});
//# sourceMappingURL=data:application/json;base64,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QUFvQixVQUFTLEdBQVQsRUFBYztBQUNoQyxTQUFLLGdCQUFMLEdBQXdCLEtBQXhCO0FBQ0EsU0FBSyxTQUFMLEdBQWlCLEdBQWpCO0FBQ0EsU0FBSyxNQUFMO0FBQ0QsR0FKbUIsQ0FJbEIsSUFKa0IsQ0FJYixJQUphLENBQXBCOztBQU1BLE9BQUssZ0JBQUwsR0FBd0IsWUFBVztBQUNqQyxTQUFLLGdCQUFMLEdBQXdCLENBQUMsS0FBSyxnQkFBOUI7QUFDRCxHQUZ1QixDQUV0QixJQUZzQixDQUVqQixJQUZpQixDQUF4QjtBQUlILENBbEtEIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbInJpb3QudGFnMignYXBwJywgJzxoZWFkZXI+IDxkaXYgY2xhc3M9XCJjb250cm9sc1wiPiA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBuYW1lPVwiYnV0dG9uXCIgaWQ9XCJuZXdHYW1lXCIgb25jbGljaz1cIntuZXdHYW1lfVwiPk5ldyBHYW1lPC9idXR0b24+IDxkaXYgY2xhc3M9XCJzaXplV3JhcHBlclwiPiA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBuYW1lPVwiYnV0dG9uXCIgaWQ9XCJzZXRTaXplXCIgb25jbGljaz1cIntzaG93U2l6ZURyb3Bkb3dufVwiPlNpemU6IHtib2FyZFNpemV9ICYjOTY2MDsgPC9idXR0b24+IDxzaXplIGlmPVwie3NldHRpbmdTaXplKCl9XCI+PC9zaXplPiA8L2Rpdj4gPGRpdiBjbGFzcz1cInVuZG9XcmFwcGVyXCI+IDxidXR0b24gaWQ9XCJ1bmRvXCIgb25jbGljaz1cInt1bmRvQ2xpY2t9XCI+VW5kbzwvYnV0dG9uPiA8YnV0dG9uIGlkPVwicmVkb1wiIG9uY2xpY2s9XCJ7cmVkb0NsaWNrfVwiPlJlZG88L2J1dHRvbj4gPC9kaXY+IDwvZGl2PiA8c2NvcmU+PC9zY29yZT4gPC9oZWFkZXI+IDx3aW5sb3NlIGlmPVwie2dhbWVTdGF0dXMgPT0gXFwnd2luXFwnfVwiPllPVSBXSU48L3dpbmxvc2U+IDx3aW5sb3NlIGlmPVwie2dhbWVTdGF0dXMgPT0gXFwnbG9zc1xcJ31cIj5ZT1UgTE9TRTwvd2lubG9zZT4gPGJvYXJkIG5hbWU9XCJib2FyZFwiIGdhbWU9XCJ7Z2FtZX1cIj48L2JvYXJkPiA8ZGl2IGNsYXNzPVwic3RhdHVzXCI+IEdhbWUgc3RhdHVzOiA8aW5wdXQgb25rZXlkb3duPVwie2hhbmRsZUtleURvd259XCIgb25rZXlwcmVzcz1cIntoYW5kbGVLZXlQcmVzc31cIiBvbmNsaWNrPVwie3VwZGF0ZUdhbWV9XCIgaWQ9XCJpbnB1dFwiIG5hbWU9XCJ0ZXN0XCIgdmFsdWU9XCJ7Z2FtZVN0YXR1c31cIiByZWFkb25seT4gPC9kaXY+JywgJycsICdvbmNsaWNrPVwie3NldEZvY3VzfVwiJywgZnVuY3Rpb24ob3B0cykge1xuXG4gICAgY29uc3QgRFJBR19FTkFCTEVEID0gZmFsc2U7XG5cbiAgICB0aGlzLmJvYXJkU2l6ZSA9IDQ7XG5cbiAgICB0aGlzLmdhbWUgPSBuZXcgR2FtZSh7XG4gICAgICBzaXplOiB0aGlzLmJvYXJkU2l6ZVxuICAgIH0pO1xuXG4gICAgdGhpcy5nYW1lLm5ld0dhbWUoKTtcblxuICAgIHRoaXMuZ2FtZVNjb3JlID0gMDtcblxuICAgIHRoaXMuc2V0dGluZ0JvYXJkU2l6ZSA9IGZhbHNlO1xuXG4gICAgdGhpcy5pc1RvdWNoRW5hYmxlZCA9IChcIm9udG91Y2hzdGFydFwiIGluIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCk7XG5cbiAgICB0aGlzLm9uKCdtb3VudCcsICgpID0+IHtcblxuICAgICAgc2V0VGltZW91dCh0aGlzLnNldEZvY3VzLCAzMDApO1xuXG4gICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xhc3NOYW1lICs9ICh0aGlzLmlzVG91Y2hFbmFibGVkID8gJyB0b3VjaCcgOiAnIG5vLXRvdWNoJyk7XG5cbiAgICAgIGNvbnN0IG1jID0gbmV3IEhhbW1lci5NYW5hZ2VyKHRoaXMuYm9hcmQpO1xuXG4gICAgICBjb25zdCBzd2lwZSA9IG5ldyBIYW1tZXIuU3dpcGUoe1xuICAgICAgICB0aHJlc2hvbGQ6IDIwXG4gICAgICB9KTtcblxuICAgICAgaWYgKERSQUdfRU5BQkxFRCkge1xuICAgICAgICBjb25zdCBwYW4gPSBuZXcgSGFtbWVyLlBhbih7XG4gICAgICAgICAgdGhyZXNob2xkOiA1XG4gICAgICAgIH0pO1xuICAgICAgICBwYW4ucmVjb2duaXplV2l0aChzd2lwZSk7XG4gICAgICAgIG1jLmFkZChwYW4pO1xuICAgICAgICBtYy5nZXQoJ3BhbicpLnNldCh7IGRpcmVjdGlvbjogSGFtbWVyLkRJUkVDVElPTl9BTEwgfSk7XG5cbiAgICAgICAgbWMub24oXCJwYW5cIiwgZXYgPT4ge1xuICAgICAgICAgIGxldCBkaXIsIGF4aXM7XG5cbiAgICAgICAgICBzd2l0Y2ggKGV2LmRpcmVjdGlvbikge1xuICAgICAgICAgICAgY2FzZSBIYW1tZXIuRElSRUNUSU9OX0xFRlQ6IGRpciA9ICdsZWZ0JzsgYXhpcyA9ICd4JzsgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIEhhbW1lci5ESVJFQ1RJT05fUklHSFQ6IGRpciA9ICdyaWdodCc7IGF4aXMgPSAneCc7IGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBIYW1tZXIuRElSRUNUSU9OX1VQOiBkaXIgPSAndXAnOyAgYXhpcyA9ICd5JzsgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIEhhbW1lci5ESVJFQ1RJT05fRE9XTjogZGlyID0gJ2Rvd24nOyAgYXhpcyA9ICd5JzticmVhaztcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB2ZW50LnRyaWdnZXIoJ2RyYWcnLCBkaXIsIGF4aXMgPT09ICd4JyA/IGV2LmRlbHRhWDowLCBheGlzID09PSAneScgPyBldi5kZWx0YVk6MCk7XG5cbiAgICAgICAgfSk7XG5cbiAgICAgICAgbWMub24oXCJwYW5zdGFydDFcIiwgZXYgPT4ge1xuICAgICAgICAgIGNvbnN0IFNUQVJUX1ggPSAwLCBTVEFSVF9ZID0gMDtcbiAgICAgICAgICBsZXQgZGlyO1xuXG4gICAgICAgICAgc3dpdGNoIChldi5kaXJlY3Rpb24pIHtcbiAgICAgICAgICAgIGNhc2UgSGFtbWVyLkRJUkVDVElPTl9MRUZUOiBkaXIgPSAnbGVmdCc7IGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBIYW1tZXIuRElSRUNUSU9OX1JJR0hUOiBkaXIgPSAncmlnaHQnOyBicmVhaztcbiAgICAgICAgICAgIGNhc2UgSGFtbWVyLkRJUkVDVElPTl9VUDogZGlyID0gJ3VwJzsgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIEhhbW1lci5ESVJFQ1RJT05fRE9XTjogZGlyID0gJ2Rvd24nOyBicmVhaztcbiAgICAgICAgICB9XG5cbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIG1jLmFkZChzd2lwZSk7XG5cbiAgICAgIG1jLm9uKCdzd2lwZScsIGUgPT4ge1xuICAgICAgICBsZXQgZGlyO1xuICAgICAgICBzd2l0Y2ggKGUuZGlyZWN0aW9uKSB7XG4gICAgICAgICAgY2FzZSBIYW1tZXIuRElSRUNUSU9OX0xFRlQ6IGRpciA9ICdsZWZ0JzsgYnJlYWs7XG4gICAgICAgICAgY2FzZSBIYW1tZXIuRElSRUNUSU9OX1JJR0hUOiBkaXIgPSAncmlnaHQnOyBicmVhaztcbiAgICAgICAgICBjYXNlIEhhbW1lci5ESVJFQ1RJT05fVVA6IGRpciA9ICd1cCc7IGJyZWFrO1xuICAgICAgICAgIGNhc2UgSGFtbWVyLkRJUkVDVElPTl9ET1dOOiBkaXIgPSAnZG93bic7IGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2VuZE1vdmUoZGlyKTtcbiAgICAgIH0pO1xuXG4gICAgfSk7XG5cbiAgICB0aGlzLmhhbmRsZUtleURvd24gPSBmdW5jdGlvbihlKSB7XG5cbiAgICAgIGUucHJldmVudFVwZGF0ZSA9IHRydWU7XG4gICAgICBjb25zdCBrZXlzID0ge1xuICAgICAgICAzNzogJ2xlZnQnLFxuICAgICAgICAzODogJ3VwJyxcbiAgICAgICAgMzk6ICdyaWdodCcsXG4gICAgICAgIDQwOiAnZG93bidcbiAgICAgIH07XG4gICAgICB0aGlzLnNlbmRNb3ZlKGtleXNbZS5rZXlDb2RlXSk7XG4gICAgfS5iaW5kKHRoaXMpXG5cbiAgICB0aGlzLnNlbmRNb3ZlID0gZnVuY3Rpb24oZGlyKSB7XG4gICAgICBpZiAoIWRpcikgcmV0dXJuIHRydWU7XG4gICAgICB0aGlzLmxhc3RNb3ZlRGlyZWN0aW9uID0gZGlyO1xuICAgICAgdGhpcy50cmlnZ2VyKCdtb3ZlJywgZGlyKTtcblxuICAgIH0uYmluZCh0aGlzKVxuXG4gICAgdGhpcy5uZXdHYW1lID0gZnVuY3Rpb24oZSkge1xuICAgICAgdGhpcy5nYW1lLm5ld0dhbWUoe1xuICAgICAgICBzaXplOiB0aGlzLmJvYXJkU2l6ZVxuICAgICAgfSk7XG4gICAgICB0aGlzLnRyaWdnZXIoJ25ld2dhbWUnKTtcbiAgICAgIHRoaXMuZ2FtZVN0YXR1cyA9ICdhY3RpdmUnO1xuICAgICAgdGhpcy5nYW1lU2NvcmUgPSAwO1xuICAgICAgdGhpcy51cGRhdGVHYW1lKCk7XG4gICAgfS5iaW5kKHRoaXMpXG5cbiAgICB0aGlzLnNldEZvY3VzID0gZnVuY3Rpb24oZSkge1xuICAgICAgaWYgKHRoaXMuaXNUb3VjaEVuYWJsZWQpIHJldHVybjtcblxuICAgICAgdGhpcy5pbnB1dC5mb2N1cygpO1xuICAgICAgaWYgKGUpIGUucHJldmVudFVwZGF0ZSA9IHRydWU7XG4gICAgfS5iaW5kKHRoaXMpXG5cbiAgICB0aGlzLnVwZGF0ZUdhbWUgPSBmdW5jdGlvbihlKSB7XG4gICAgICB0aGlzLnVwZGF0ZSgpO1xuICAgIH0uYmluZCh0aGlzKVxuXG4gICAgdGhpcy51bmRvQ2xpY2sgPSBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuZ2FtZS51bmRvKCk7XG4gICAgICB0aGlzLnRyaWdnZXIoJ21vdmUgbW92ZWQnKTtcbiAgICB9LmJpbmQodGhpcylcblxuICAgIHRoaXMucmVkb0NsaWNrID0gZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLmdhbWUucmVkbygpO1xuICAgICAgdGhpcy50cmlnZ2VyKCdtb3ZlIG1vdmVkJyk7XG4gICAgfS5iaW5kKHRoaXMpXG5cbiAgICB0aGlzLm9uKCdtb3ZlZCcsICgpID0+IHtcbiAgICAgIHRoaXMuZ2FtZVN0YXR1cyA9IHRoaXMuZ2FtZS5nYW1lU3RhdHVzKCk7XG4gICAgICB0aGlzLmdhbWVTY29yZSA9IHRoaXMuZ2FtZS5zY29yZTtcbiAgICAgIHRoaXMudXBkYXRlKCApO1xuICAgIH0pO1xuXG4gICAgdGhpcy5oYW5kbGVLZXlQcmVzcyA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgIGlmICghKGUuY3RybEtleSB8fCBlLm1ldGFLZXkgfHwgZS5hbHRLZXkpKSB7XG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIH1cbiAgICB9LmJpbmQodGhpcylcblxuICAgIHRoaXMuZ2V0TW92aW5nQ2xhc3MgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIFwibW92aW5nLVwiICsgdGhpcy5sYXN0TW92ZURpcmVjdGlvbjtcbiAgICB9LmJpbmQodGhpcylcblxuICAgIHRoaXMuc2V0dGluZ1NpemUgPSBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLnNldHRpbmdCb2FyZFNpemU7XG4gICAgfS5iaW5kKHRoaXMpXG5cbiAgICB0aGlzLnNldEJvYXJkU2l6ZSA9IGZ1bmN0aW9uKHZhbCkge1xuICAgICAgdGhpcy5zZXR0aW5nQm9hcmRTaXplID0gZmFsc2U7XG4gICAgICB0aGlzLmJvYXJkU2l6ZSA9IHZhbDtcbiAgICAgIHRoaXMudXBkYXRlKCk7XG4gICAgfS5iaW5kKHRoaXMpXG5cbiAgICB0aGlzLnNob3dTaXplRHJvcGRvd24gPSBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuc2V0dGluZ0JvYXJkU2l6ZSA9ICF0aGlzLnNldHRpbmdCb2FyZFNpemU7XG4gICAgfS5iaW5kKHRoaXMpXG5cbn0pOyJdfQ==
'use strict';

riot.tag2('block', '<label animate="{this.getAnimations()}" animate-leave="zoomOut" animate-duration="300ms">{opts.bv.val}</label>', '', 'class="{this.getLevelClass()}"', function (opts) {
  var _this = this;

  this.mixin(riotAnimate);

  this.getAnimations = function () {
    var classes = [];
    if (_this.opts.new) classes.push('bounceIn');
    if (_this.opts.combined) classes.push('flipInY');
    if (_this.moving) classes.push('fadeOut');
    return classes.join(' ');
  };

  this.getLevelClass = function () {
    var val = _this.opts.bv.val;
    var level = Math.log(val) / Math.log(2);
    return 'level' + level;
  };

  this.blockMargin = 0;

  var self = this;

  this.move = function () {

    var delta = self.opts.bv.delta;
    if (delta) {

      var marginAdjustX = delta.dx * self.blockMargin,
          marginAdjustY = delta.dy * self.blockMargin;

      self.moving = true;

      if (delta.removed) self.animatedUnmount();

      self.update();

      Velocity(self.root, {
        left: self.root.offsetWidth * delta.dx + marginAdjustX + 'px',
        top: self.root.offsetHeight * delta.dy + marginAdjustY + 'px'
      }, {
        duration: 100,
        complete: function complete() {
          self.moving = false;
        }
      });
    }
  };

  this.drag = function (dir, dx, dy) {

    if (!self.opts.bv.possibleMoves.some(function (m) {
      return m == dir;
    })) return;

    var translate = 'translate3d(' + dx + 'px, ' + dy + 'px, 0)';
    self.root.style.transform = translate;
    self.root.style.mozTransform = translate;
    self.root.style.webkitTransform = translate;
  };

  vent.on('moveblocks', this.move);
  vent.on('drag', this.drag);

  this.on('mount', function () {});
  this.on('before-unmount', function () {
    vent.off('moveblocks', this.move);
    vent.off('drag', this.drag);
  });

  this.on('updated', function () {

    var minFontSize = 5,
        maxFontSize = 100,
        compressor = .2,
        el = this.root;

    el.style.fontSize = Math.max(Math.min(el.clientWidth / (compressor * 10), Math.min(el.clientHeight, maxFontSize)), minFontSize) + 'px';

    if (this.root && this.root.parentElement) {
      var style = this.root.parentElement.currentStyle || window.getComputedStyle(this.root.parentElement);

      this.blockMargin = parseInt(style.marginRight, 10) * 2;
    }
  });
  this.on('mount', function () {});
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJsb2NrLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsS0FBSyxJQUFMLENBQVUsT0FBVixFQUFtQixnSEFBbkIsRUFBcUksRUFBckksRUFBeUksZ0NBQXpJLEVBQTJLLFVBQVMsSUFBVCxFQUFlO0FBQUE7O0FBQ3RMLE9BQUssS0FBTCxDQUFXLFdBQVg7O0FBRUEsT0FBSyxhQUFMLEdBQXFCLFlBQU07QUFDekIsUUFBTSxVQUFVLEVBQWhCO0FBQ0EsUUFBSSxNQUFLLElBQUwsQ0FBVSxHQUFkLEVBQ0UsUUFBUSxJQUFSLENBQWEsVUFBYjtBQUNGLFFBQUksTUFBSyxJQUFMLENBQVUsUUFBZCxFQUNFLFFBQVEsSUFBUixDQUFhLFNBQWI7QUFDRixRQUFJLE1BQUssTUFBVCxFQUNFLFFBQVEsSUFBUixDQUFhLFNBQWI7QUFDRixXQUFPLFFBQVEsSUFBUixDQUFhLEdBQWIsQ0FBUDtBQUNELEdBVEQ7O0FBV0EsT0FBSyxhQUFMLEdBQXFCLFlBQU07QUFDekIsUUFBTSxNQUFNLE1BQUssSUFBTCxDQUFVLEVBQVYsQ0FBYSxHQUF6QjtBQUNBLFFBQU0sUUFBUSxLQUFLLEdBQUwsQ0FBUyxHQUFULElBQWdCLEtBQUssR0FBTCxDQUFTLENBQVQsQ0FBOUI7QUFDQSxXQUFPLFVBQVUsS0FBakI7QUFDRCxHQUpEOztBQU1BLE9BQUssV0FBTCxHQUFtQixDQUFuQjs7QUFFQSxNQUFNLE9BQU8sSUFBYjs7QUFFQSxPQUFLLElBQUwsR0FBWSxZQUFNOztBQUVoQixRQUFNLFFBQVEsS0FBSyxJQUFMLENBQVUsRUFBVixDQUFhLEtBQTNCO0FBQ0EsUUFBSSxLQUFKLEVBQVc7O0FBRVQsVUFBTSxnQkFBZ0IsTUFBTSxFQUFOLEdBQVcsS0FBSyxXQUF0QztBQUFBLFVBQW1ELGdCQUFnQixNQUFNLEVBQU4sR0FBVyxLQUFLLFdBQW5GOztBQUVBLFdBQUssTUFBTCxHQUFjLElBQWQ7O0FBRUEsVUFBSSxNQUFNLE9BQVYsRUFDRSxLQUFLLGVBQUw7O0FBRUYsV0FBSyxNQUFMOztBQUVBLGVBQVMsS0FBSyxJQUFkLEVBQ0k7QUFDRSxjQUFPLEtBQUssSUFBTCxDQUFVLFdBQVYsR0FBd0IsTUFBTSxFQUEvQixHQUFxQyxhQUFyQyxHQUFxRCxJQUQ3RDtBQUVFLGFBQU0sS0FBSyxJQUFMLENBQVUsWUFBVixHQUF5QixNQUFNLEVBQWhDLEdBQXNDLGFBQXRDLEdBQXNEO0FBRjdELE9BREosRUFLSTtBQUNFLGtCQUFVLEdBRFo7QUFFRSxrQkFBVSxvQkFBTTtBQUNkLGVBQUssTUFBTCxHQUFjLEtBQWQ7QUFDRDtBQUpILE9BTEo7QUFZRDtBQUNGLEdBM0JEOztBQTZCQSxPQUFLLElBQUwsR0FBWSxVQUFDLEdBQUQsRUFBTSxFQUFOLEVBQVUsRUFBVixFQUFpQjs7QUFFM0IsUUFBSSxDQUFDLEtBQUssSUFBTCxDQUFVLEVBQVYsQ0FBYSxhQUFiLENBQTJCLElBQTNCLENBQWdDO0FBQUEsYUFBSyxLQUFLLEdBQVY7QUFBQSxLQUFoQyxDQUFMLEVBQXFEOztBQUVyRCxRQUFNLDZCQUNhLEVBRGIsWUFDc0IsRUFEdEIsV0FBTjtBQUVBLFNBQUssSUFBTCxDQUFVLEtBQVYsQ0FBZ0IsU0FBaEIsR0FBNEIsU0FBNUI7QUFDQSxTQUFLLElBQUwsQ0FBVSxLQUFWLENBQWdCLFlBQWhCLEdBQStCLFNBQS9CO0FBQ0EsU0FBSyxJQUFMLENBQVUsS0FBVixDQUFnQixlQUFoQixHQUFrQyxTQUFsQztBQUVELEdBVkQ7O0FBWUEsT0FBSyxFQUFMLENBQVEsWUFBUixFQUFzQixLQUFLLElBQTNCO0FBQ0EsT0FBSyxFQUFMLENBQVEsTUFBUixFQUFnQixLQUFLLElBQXJCOztBQUVBLE9BQUssRUFBTCxDQUFRLE9BQVIsRUFBaUIsWUFBVyxDQUUzQixDQUZEO0FBR0EsT0FBSyxFQUFMLENBQVEsZ0JBQVIsRUFBMEIsWUFBVztBQUNuQyxTQUFLLEdBQUwsQ0FBUyxZQUFULEVBQXVCLEtBQUssSUFBNUI7QUFDQSxTQUFLLEdBQUwsQ0FBUyxNQUFULEVBQWlCLEtBQUssSUFBdEI7QUFDRCxHQUhEOztBQUtBLE9BQUssRUFBTCxDQUFRLFNBQVIsRUFBbUIsWUFBVzs7QUFFNUIsUUFBSSxjQUFjLENBQWxCO0FBQUEsUUFBcUIsY0FBYyxHQUFuQztBQUFBLFFBQXdDLGFBQWEsRUFBckQ7QUFBQSxRQUF5RCxLQUFLLEtBQUssSUFBbkU7O0FBRUEsT0FBRyxLQUFILENBQVMsUUFBVCxHQUFvQixLQUFLLEdBQUwsQ0FBUyxLQUFLLEdBQUwsQ0FBUyxHQUFHLFdBQUgsSUFBa0IsYUFBVyxFQUE3QixDQUFULEVBQTJDLEtBQUssR0FBTCxDQUFTLEdBQUcsWUFBWixFQUEwQixXQUExQixDQUEzQyxDQUFULEVBQTZGLFdBQTdGLElBQTRHLElBQWhJOztBQUVBLFFBQUksS0FBSyxJQUFMLElBQWEsS0FBSyxJQUFMLENBQVUsYUFBM0IsRUFBMEM7QUFDeEMsVUFBTSxRQUFRLEtBQUssSUFBTCxDQUFVLGFBQVYsQ0FBd0IsWUFBeEIsSUFBd0MsT0FBTyxnQkFBUCxDQUF3QixLQUFLLElBQUwsQ0FBVSxhQUFsQyxDQUF0RDs7QUFFQSxXQUFLLFdBQUwsR0FBbUIsU0FBUyxNQUFNLFdBQWYsRUFBNEIsRUFBNUIsSUFBa0MsQ0FBckQ7QUFDRDtBQUVGLEdBWkQ7QUFhQSxPQUFLLEVBQUwsQ0FBUSxPQUFSLEVBQWlCLFlBQVcsQ0FFM0IsQ0FGRDtBQUdILENBNUZEIiwiZmlsZSI6ImJsb2NrLmpzIiwic291cmNlc0NvbnRlbnQiOlsicmlvdC50YWcyKCdibG9jaycsICc8bGFiZWwgYW5pbWF0ZT1cInt0aGlzLmdldEFuaW1hdGlvbnMoKX1cIiBhbmltYXRlLWxlYXZlPVwiem9vbU91dFwiIGFuaW1hdGUtZHVyYXRpb249XCIzMDBtc1wiPntvcHRzLmJ2LnZhbH08L2xhYmVsPicsICcnLCAnY2xhc3M9XCJ7dGhpcy5nZXRMZXZlbENsYXNzKCl9XCInLCBmdW5jdGlvbihvcHRzKSB7XG4gICAgdGhpcy5taXhpbihyaW90QW5pbWF0ZSk7XG5cbiAgICB0aGlzLmdldEFuaW1hdGlvbnMgPSAoKSA9PiB7XG4gICAgICBjb25zdCBjbGFzc2VzID0gW107XG4gICAgICBpZiAodGhpcy5vcHRzLm5ldylcbiAgICAgICAgY2xhc3Nlcy5wdXNoKCdib3VuY2VJbicpO1xuICAgICAgaWYgKHRoaXMub3B0cy5jb21iaW5lZClcbiAgICAgICAgY2xhc3Nlcy5wdXNoKCdmbGlwSW5ZJyk7XG4gICAgICBpZiAodGhpcy5tb3ZpbmcpXG4gICAgICAgIGNsYXNzZXMucHVzaCgnZmFkZU91dCcpO1xuICAgICAgcmV0dXJuIGNsYXNzZXMuam9pbignICcpO1xuICAgIH07XG5cbiAgICB0aGlzLmdldExldmVsQ2xhc3MgPSAoKSA9PiB7XG4gICAgICBjb25zdCB2YWwgPSB0aGlzLm9wdHMuYnYudmFsO1xuICAgICAgY29uc3QgbGV2ZWwgPSBNYXRoLmxvZyh2YWwpIC8gTWF0aC5sb2coMik7XG4gICAgICByZXR1cm4gJ2xldmVsJyArIGxldmVsO1xuICAgIH07XG5cbiAgICB0aGlzLmJsb2NrTWFyZ2luID0gMDtcblxuICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgdGhpcy5tb3ZlID0gKCkgPT4ge1xuXG4gICAgICBjb25zdCBkZWx0YSA9IHNlbGYub3B0cy5idi5kZWx0YTtcbiAgICAgIGlmIChkZWx0YSkge1xuXG4gICAgICAgIGNvbnN0IG1hcmdpbkFkanVzdFggPSBkZWx0YS5keCAqIHNlbGYuYmxvY2tNYXJnaW4sIG1hcmdpbkFkanVzdFkgPSBkZWx0YS5keSAqIHNlbGYuYmxvY2tNYXJnaW47XG5cbiAgICAgICAgc2VsZi5tb3ZpbmcgPSB0cnVlO1xuXG4gICAgICAgIGlmIChkZWx0YS5yZW1vdmVkKVxuICAgICAgICAgIHNlbGYuYW5pbWF0ZWRVbm1vdW50KCk7XG5cbiAgICAgICAgc2VsZi51cGRhdGUoKTtcblxuICAgICAgICBWZWxvY2l0eShzZWxmLnJvb3QsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGxlZnQ6IChzZWxmLnJvb3Qub2Zmc2V0V2lkdGggKiBkZWx0YS5keCkgKyBtYXJnaW5BZGp1c3RYICsgJ3B4JyxcbiAgICAgICAgICAgICAgdG9wOiAoc2VsZi5yb290Lm9mZnNldEhlaWdodCAqIGRlbHRhLmR5KSArIG1hcmdpbkFkanVzdFkgKyAncHgnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBkdXJhdGlvbjogMTAwLFxuICAgICAgICAgICAgICBjb21wbGV0ZTogKCkgPT4ge1xuICAgICAgICAgICAgICAgIHNlbGYubW92aW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5kcmFnID0gKGRpciwgZHgsIGR5KSA9PiB7XG5cbiAgICAgIGlmICghc2VsZi5vcHRzLmJ2LnBvc3NpYmxlTW92ZXMuc29tZShtID0+IG0gPT0gZGlyKSkgcmV0dXJuO1xuXG4gICAgICBjb25zdCB0cmFuc2xhdGVcbiAgICAgICAgPSBgdHJhbnNsYXRlM2QoJHtkeH1weCwgJHtkeX1weCwgMClgO1xuICAgICAgc2VsZi5yb290LnN0eWxlLnRyYW5zZm9ybSA9IHRyYW5zbGF0ZTtcbiAgICAgIHNlbGYucm9vdC5zdHlsZS5tb3pUcmFuc2Zvcm0gPSB0cmFuc2xhdGU7XG4gICAgICBzZWxmLnJvb3Quc3R5bGUud2Via2l0VHJhbnNmb3JtID0gdHJhbnNsYXRlO1xuXG4gICAgfTtcblxuICAgIHZlbnQub24oJ21vdmVibG9ja3MnLCB0aGlzLm1vdmUpO1xuICAgIHZlbnQub24oJ2RyYWcnLCB0aGlzLmRyYWcpO1xuXG4gICAgdGhpcy5vbignbW91bnQnLCBmdW5jdGlvbigpIHtcblxuICAgIH0pO1xuICAgIHRoaXMub24oJ2JlZm9yZS11bm1vdW50JywgZnVuY3Rpb24oKSB7XG4gICAgICB2ZW50Lm9mZignbW92ZWJsb2NrcycsIHRoaXMubW92ZSk7XG4gICAgICB2ZW50Lm9mZignZHJhZycsIHRoaXMuZHJhZyk7XG4gICAgfSk7XG5cbiAgICB0aGlzLm9uKCd1cGRhdGVkJywgZnVuY3Rpb24oKSB7XG5cbiAgICAgIGxldCBtaW5Gb250U2l6ZSA9IDUsIG1heEZvbnRTaXplID0gMTAwLCBjb21wcmVzc29yID0gLjIsIGVsID0gdGhpcy5yb290O1xuXG4gICAgICBlbC5zdHlsZS5mb250U2l6ZSA9IE1hdGgubWF4KE1hdGgubWluKGVsLmNsaWVudFdpZHRoIC8gKGNvbXByZXNzb3IqMTApLCBNYXRoLm1pbihlbC5jbGllbnRIZWlnaHQsIG1heEZvbnRTaXplKSksIG1pbkZvbnRTaXplKSArICdweCc7XG5cbiAgICAgIGlmICh0aGlzLnJvb3QgJiYgdGhpcy5yb290LnBhcmVudEVsZW1lbnQpIHtcbiAgICAgICAgY29uc3Qgc3R5bGUgPSB0aGlzLnJvb3QucGFyZW50RWxlbWVudC5jdXJyZW50U3R5bGUgfHwgd2luZG93LmdldENvbXB1dGVkU3R5bGUodGhpcy5yb290LnBhcmVudEVsZW1lbnQpO1xuXG4gICAgICAgIHRoaXMuYmxvY2tNYXJnaW4gPSBwYXJzZUludChzdHlsZS5tYXJnaW5SaWdodCwgMTApICogMjtcbiAgICAgIH1cblxuICAgIH0pO1xuICAgIHRoaXMub24oJ21vdW50JywgZnVuY3Rpb24oKSB7XG5cbiAgICB9KTtcbn0pO1xuIl19
'use strict';

riot.tag2('board', '<div class="row" each="{row, y in boardRows}"> <space each="{tmp, x in row}" bv="{getVal(y, x)}" new="{isNew(y,x)}" x="{x}" y="{y}" combined="{isCombined(y,x)}" class="{new: isNew(y,x)}"></space> </div>', '', '', function (opts) {
  var _this = this;

  this.game = opts.game;
  this.timeout = null;

  function cloneMatrix(matrix) {
    var size = matrix.length,
        newMatrix = new Array(size);
    for (var y = 0; y < size; y++) {
      newMatrix[y] = new Array(size);
      for (var x = 0; x < size; x++) {
        newMatrix[y][x] = matrix[y][x];
      }
    }
    return newMatrix;
  }

  function updateMoves(matrix, moves) {
    var size = matrix.length,
        newMatrix = new Array(size);
    for (var y = 0; y < size; y++) {
      newMatrix[y] = new Array(size);
      for (var x = 0; x < size; x++) {
        var block = matrix[y][x];
        block.delta = moves[y][x];
        block.isNew = false;
        newMatrix[y][x] = block;
      }
    }
    return newMatrix;
  }

  this.on('mount', function () {
    _this.boardRows = cloneMatrix(_this.game.rows);
    window.addEventListener('resize', _this.update.bind(_this));
    window.addEventListener('orientationchange', _this.update.bind(_this));
    _this.update();
  });

  this.parent.on('newgame', function () {
    _this.boardRows = cloneMatrix(_this.game.rows);
    _this.update();
  });

  this.parent.on('move', function (dir) {
    _this.trigger('move');
    if (dir) {

      if (_this.game.gameStatus() != 'active') return;

      if (_this.timeout) {
        return;
      }

      _this.lastBoardRows = _this.boardRows = updateMoves(_this.boardRows, _this.game.getBlockMovements(dir));

      vent.trigger('moveblocks');

      _this.timeout = setTimeout(function () {
        if (dir) _this.game.processMove(dir);
        _this.boardRows = cloneMatrix(_this.game.rows);
        _this.update();
        _this.parent.trigger('moved');

        _this.timeout = null;
      }, 100);
    } else {
      _this.boardRows = _this.game.rows;
      _this.update();
    }
  });

  this.mixin(riotAnimate);

  this.isNew = function (y, x) {
    return this.game.rows[y][x].isNew;
  }.bind(this);

  this.isCombined = function (y, x) {
    return this.lastBoardRows[y][x].delta.combined;
  }.bind(this);

  this.getVal = function (y, x) {
    return this.boardRows[y][x];
  }.bind(this);

  this.on('before-update', function () {
    vent.off('*');
  });
});
//# sourceMappingURL=data:application/json;base64,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LGNBQUssU0FBTCxHQUFpQixZQUFZLE1BQUssSUFBTCxDQUFVLElBQXRCLENBQWpCO0FBQ0EsY0FBSyxNQUFMO0FBQ0YsY0FBSyxNQUFMLENBQVksT0FBWixDQUFvQixPQUFwQjs7QUFFRixjQUFLLE9BQUwsR0FBZSxJQUFmO0FBQ0MsT0FQWSxFQU9WLEdBUFUsQ0FBZjtBQVNELEtBckJELE1BcUJPO0FBQ0gsWUFBSyxTQUFMLEdBQWlCLE1BQUssSUFBTCxDQUFVLElBQTNCO0FBQ0EsWUFBSyxNQUFMO0FBQ0g7QUFFRixHQTVCRDs7QUE4QkEsT0FBSyxLQUFMLENBQVcsV0FBWDs7QUFFQSxPQUFLLEtBQUwsR0FBYSxVQUFTLENBQVQsRUFBVyxDQUFYLEVBQWM7QUFDekIsV0FBTyxLQUFLLElBQUwsQ0FBVSxJQUFWLENBQWUsQ0FBZixFQUFrQixDQUFsQixFQUFxQixLQUE1QjtBQUNELEdBRlksQ0FFWCxJQUZXLENBRU4sSUFGTSxDQUFiOztBQUlBLE9BQUssVUFBTCxHQUFrQixVQUFTLENBQVQsRUFBVyxDQUFYLEVBQWM7QUFDOUIsV0FBTyxLQUFLLGFBQUwsQ0FBbUIsQ0FBbkIsRUFBc0IsQ0FBdEIsRUFBeUIsS0FBekIsQ0FBK0IsUUFBdEM7QUFDRCxHQUZpQixDQUVoQixJQUZnQixDQUVYLElBRlcsQ0FBbEI7O0FBSUEsT0FBSyxNQUFMLEdBQWMsVUFBUyxDQUFULEVBQVcsQ0FBWCxFQUFjO0FBQzFCLFdBQU8sS0FBSyxTQUFMLENBQWUsQ0FBZixFQUFrQixDQUFsQixDQUFQO0FBQ0QsR0FGYSxDQUVaLElBRlksQ0FFUCxJQUZPLENBQWQ7O0FBSUEsT0FBSyxFQUFMLENBQVEsZUFBUixFQUF5QixZQUFXO0FBQ2xDLFNBQUssR0FBTCxDQUFTLEdBQVQ7QUFDRCxHQUZEO0FBSUgsQ0F6RkQiLCJmaWxlIjoiYm9hcmQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJyaW90LnRhZzIoJ2JvYXJkJywgJzxkaXYgY2xhc3M9XCJyb3dcIiBlYWNoPVwie3JvdywgeSBpbiBib2FyZFJvd3N9XCI+IDxzcGFjZSBlYWNoPVwie3RtcCwgeCBpbiByb3d9XCIgYnY9XCJ7Z2V0VmFsKHksIHgpfVwiIG5ldz1cIntpc05ldyh5LHgpfVwiIHg9XCJ7eH1cIiB5PVwie3l9XCIgY29tYmluZWQ9XCJ7aXNDb21iaW5lZCh5LHgpfVwiIGNsYXNzPVwie25ldzogaXNOZXcoeSx4KX1cIj48L3NwYWNlPiA8L2Rpdj4nLCAnJywgJycsIGZ1bmN0aW9uKG9wdHMpIHtcbiAgICB0aGlzLmdhbWUgPSBvcHRzLmdhbWU7XG4gICAgdGhpcy50aW1lb3V0ID0gbnVsbDtcblxuICAgIGZ1bmN0aW9uIGNsb25lTWF0cml4KG1hdHJpeCkge1xuICAgICAgdmFyIHNpemUgPSBtYXRyaXgubGVuZ3RoLCBuZXdNYXRyaXggPSBuZXcgQXJyYXkoc2l6ZSk7XG4gICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IHNpemU7IHkrKykge1xuICAgICAgICBuZXdNYXRyaXhbeV0gPSBuZXcgQXJyYXkoc2l6ZSk7XG4gICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgc2l6ZTsgeCsrKSB7XG4gICAgICAgICAgbmV3TWF0cml4W3ldW3hdID0gbWF0cml4W3ldW3hdO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gbmV3TWF0cml4O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHVwZGF0ZU1vdmVzKG1hdHJpeCwgbW92ZXMpIHtcbiAgICAgIHZhciBzaXplID0gbWF0cml4Lmxlbmd0aCwgbmV3TWF0cml4ID0gbmV3IEFycmF5KHNpemUpO1xuICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCBzaXplOyB5KyspIHtcbiAgICAgICAgbmV3TWF0cml4W3ldID0gbmV3IEFycmF5KHNpemUpO1xuICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IHNpemU7IHgrKykge1xuICAgICAgICAgIGxldCBibG9jayA9IG1hdHJpeFt5XVt4XTtcbiAgICAgICAgICBibG9jay5kZWx0YSA9IG1vdmVzW3ldW3hdO1xuICAgICAgICAgIGJsb2NrLmlzTmV3ID0gZmFsc2U7XG4gICAgICAgICAgbmV3TWF0cml4W3ldW3hdID0gYmxvY2s7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBuZXdNYXRyaXg7XG4gICAgfVxuXG4gICAgdGhpcy5vbignbW91bnQnLCAoKSA9PiB7XG4gICAgICB0aGlzLmJvYXJkUm93cyA9IGNsb25lTWF0cml4KHRoaXMuZ2FtZS5yb3dzKTtcbiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCB0aGlzLnVwZGF0ZS5iaW5kKHRoaXMpKTtcbiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdvcmllbnRhdGlvbmNoYW5nZScsIHRoaXMudXBkYXRlLmJpbmQodGhpcykpO1xuICAgICAgdGhpcy51cGRhdGUoKTtcbiAgICB9KTtcblxuICAgIHRoaXMucGFyZW50Lm9uKCduZXdnYW1lJywgKCkgPT4ge1xuICAgICAgdGhpcy5ib2FyZFJvd3MgPSBjbG9uZU1hdHJpeCh0aGlzLmdhbWUucm93cyk7XG4gICAgICB0aGlzLnVwZGF0ZSgpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5wYXJlbnQub24oJ21vdmUnLCAoZGlyKSA9PiB7XG4gICAgICB0aGlzLnRyaWdnZXIoJ21vdmUnKTtcbiAgICAgIGlmIChkaXIpIHtcblxuICAgICAgICBpZiAodGhpcy5nYW1lLmdhbWVTdGF0dXMoKSAhPSAnYWN0aXZlJykgcmV0dXJuO1xuXG4gICAgICAgIGlmICh0aGlzLnRpbWVvdXQpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmxhc3RCb2FyZFJvd3MgPSB0aGlzLmJvYXJkUm93cyA9IHVwZGF0ZU1vdmVzKHRoaXMuYm9hcmRSb3dzLCB0aGlzLmdhbWUuZ2V0QmxvY2tNb3ZlbWVudHMoZGlyKSk7XG5cbiAgICAgICAgdmVudC50cmlnZ2VyKCdtb3ZlYmxvY2tzJyk7XG5cbiAgICAgICAgdGhpcy50aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgIGlmIChkaXIpIHRoaXMuZ2FtZS5wcm9jZXNzTW92ZShkaXIpO1xuICAgICAgICAgICAgICB0aGlzLmJvYXJkUm93cyA9IGNsb25lTWF0cml4KHRoaXMuZ2FtZS5yb3dzKTtcbiAgICAgICAgICAgICAgdGhpcy51cGRhdGUoKTtcbiAgICAgICAgICAgIHRoaXMucGFyZW50LnRyaWdnZXIoJ21vdmVkJyk7XG5cbiAgICAgICAgICB0aGlzLnRpbWVvdXQgPSBudWxsO1xuICAgICAgICAgIH0sIDEwMCk7XG5cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5ib2FyZFJvd3MgPSB0aGlzLmdhbWUucm93cztcbiAgICAgICAgICB0aGlzLnVwZGF0ZSgpO1xuICAgICAgfVxuXG4gICAgfSk7XG5cbiAgICB0aGlzLm1peGluKHJpb3RBbmltYXRlKTtcblxuICAgIHRoaXMuaXNOZXcgPSBmdW5jdGlvbih5LHgpIHtcbiAgICAgIHJldHVybiB0aGlzLmdhbWUucm93c1t5XVt4XS5pc05ldztcbiAgICB9LmJpbmQodGhpcylcblxuICAgIHRoaXMuaXNDb21iaW5lZCA9IGZ1bmN0aW9uKHkseCkge1xuICAgICAgcmV0dXJuIHRoaXMubGFzdEJvYXJkUm93c1t5XVt4XS5kZWx0YS5jb21iaW5lZDtcbiAgICB9LmJpbmQodGhpcylcblxuICAgIHRoaXMuZ2V0VmFsID0gZnVuY3Rpb24oeSx4KSB7XG4gICAgICByZXR1cm4gdGhpcy5ib2FyZFJvd3NbeV1beF07XG4gICAgfS5iaW5kKHRoaXMpXG5cbiAgICB0aGlzLm9uKCdiZWZvcmUtdXBkYXRlJywgZnVuY3Rpb24oKSB7XG4gICAgICB2ZW50Lm9mZignKicpO1xuICAgIH0pO1xuXG59KTtcbiJdfQ==
'use strict';

riot.tag2('score', '<div> <div class="label">Score</div> <div class="value">{parent.gameScore}</div> </div>', '.label { color: #fff; font-size: .8em; }', '', function (opts) {});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjb3JlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsS0FBSyxJQUFMLENBQVUsT0FBVixFQUFtQix5RkFBbkIsRUFBOEcsMENBQTlHLEVBQTBKLEVBQTFKLEVBQThKLFVBQVMsSUFBVCxFQUFlLENBQzVLLENBREQiLCJmaWxlIjoic2NvcmUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJyaW90LnRhZzIoJ3Njb3JlJywgJzxkaXY+IDxkaXYgY2xhc3M9XCJsYWJlbFwiPlNjb3JlPC9kaXY+IDxkaXYgY2xhc3M9XCJ2YWx1ZVwiPntwYXJlbnQuZ2FtZVNjb3JlfTwvZGl2PiA8L2Rpdj4nLCAnLmxhYmVsIHsgY29sb3I6ICNmZmY7IGZvbnQtc2l6ZTogLjhlbTsgfScsICcnLCBmdW5jdGlvbihvcHRzKSB7XG59KTtcbiJdfQ==
'use strict';

riot.tag2('size', '<div each="{val, i in sizes}" onclick="{setSize}"> {val} <span if="{val === parent.boardSize}">&#10004;</span> </div>', 'size div { cursor: pointer; padding: 4px; }', '', function (opts) {

    this.sizes = [2, 3, 4, 5, 6, 7, 8, 9, 10];

    this.setSize = function (e) {
        this.parent.setBoardSize(e.item.val);
    }.bind(this);
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNpemUuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxLQUFLLElBQUwsQ0FBVSxNQUFWLEVBQWtCLHVIQUFsQixFQUEySSw2Q0FBM0ksRUFBMEwsRUFBMUwsRUFBOEwsVUFBUyxJQUFULEVBQWU7O0FBRXpNLFNBQUssS0FBTCxHQUFhLENBQUMsQ0FBRCxFQUFJLENBQUosRUFBTyxDQUFQLEVBQVUsQ0FBVixFQUFhLENBQWIsRUFBZ0IsQ0FBaEIsRUFBbUIsQ0FBbkIsRUFBc0IsQ0FBdEIsRUFBeUIsRUFBekIsQ0FBYjs7QUFFQSxTQUFLLE9BQUwsR0FBZSxVQUFTLENBQVQsRUFBWTtBQUN6QixhQUFLLE1BQUwsQ0FBWSxZQUFaLENBQXlCLEVBQUUsSUFBRixDQUFPLEdBQWhDO0FBQ0QsS0FGYyxDQUViLElBRmEsQ0FFUixJQUZRLENBQWY7QUFJSCxDQVJEIiwiZmlsZSI6InNpemUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJyaW90LnRhZzIoJ3NpemUnLCAnPGRpdiBlYWNoPVwie3ZhbCwgaSBpbiBzaXplc31cIiBvbmNsaWNrPVwie3NldFNpemV9XCI+IHt2YWx9IDxzcGFuIGlmPVwie3ZhbCA9PT0gcGFyZW50LmJvYXJkU2l6ZX1cIj4mIzEwMDA0Ozwvc3Bhbj4gPC9kaXY+JywgJ3NpemUgZGl2IHsgY3Vyc29yOiBwb2ludGVyOyBwYWRkaW5nOiA0cHg7IH0nLCAnJywgZnVuY3Rpb24ob3B0cykge1xuXG4gICAgdGhpcy5zaXplcyA9IFsyLCAzLCA0LCA1LCA2LCA3LCA4LCA5LCAxMF07XG5cbiAgICB0aGlzLnNldFNpemUgPSBmdW5jdGlvbihlKSB7XG4gICAgICB0aGlzLnBhcmVudC5zZXRCb2FyZFNpemUoZS5pdGVtLnZhbCk7XG4gICAgfS5iaW5kKHRoaXMpXG5cbn0pO1xuIl19
'use strict';

riot.tag2('space', '<block if="{opts.bv.val != 0}" bv="{opts.bv}" new="{opts.new}" combined="{opts.combined}" moving="{isMoving(y,x)}"> </block>', '', '', function (opts) {
  var _this = this;

  this.mixin(riotAnimate);

  this.isMoving = function (y, x) {
    return this.boardRows[y][x].delta.dx || this.boardRows[y][x].delta.dy;
  }.bind(this);

  this.on('mount', function () {
    _this.block = opts.bv;
  });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNwYWNlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsS0FBSyxJQUFMLENBQVUsT0FBVixFQUFtQiw4SEFBbkIsRUFBbUosRUFBbkosRUFBdUosRUFBdkosRUFBMkosVUFBUyxJQUFULEVBQWU7QUFBQTs7QUFFdEssT0FBSyxLQUFMLENBQVcsV0FBWDs7QUFFQSxPQUFLLFFBQUwsR0FBZ0IsVUFBUyxDQUFULEVBQVcsQ0FBWCxFQUFjO0FBQzVCLFdBQU8sS0FBSyxTQUFMLENBQWUsQ0FBZixFQUFrQixDQUFsQixFQUFxQixLQUFyQixDQUEyQixFQUEzQixJQUFpQyxLQUFLLFNBQUwsQ0FBZSxDQUFmLEVBQWtCLENBQWxCLEVBQXFCLEtBQXJCLENBQTJCLEVBQW5FO0FBQ0QsR0FGZSxDQUVkLElBRmMsQ0FFVCxJQUZTLENBQWhCOztBQUlBLE9BQUssRUFBTCxDQUFRLE9BQVIsRUFBaUIsWUFBTTtBQUNyQixVQUFLLEtBQUwsR0FBYSxLQUFLLEVBQWxCO0FBQ0QsR0FGRDtBQUlILENBWkQiLCJmaWxlIjoic3BhY2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyJyaW90LnRhZzIoJ3NwYWNlJywgJzxibG9jayBpZj1cIntvcHRzLmJ2LnZhbCAhPSAwfVwiIGJ2PVwie29wdHMuYnZ9XCIgbmV3PVwie29wdHMubmV3fVwiIGNvbWJpbmVkPVwie29wdHMuY29tYmluZWR9XCIgbW92aW5nPVwie2lzTW92aW5nKHkseCl9XCI+IDwvYmxvY2s+JywgJycsICcnLCBmdW5jdGlvbihvcHRzKSB7XG5cbiAgICB0aGlzLm1peGluKHJpb3RBbmltYXRlKTtcblxuICAgIHRoaXMuaXNNb3ZpbmcgPSBmdW5jdGlvbih5LHgpIHtcbiAgICAgIHJldHVybiB0aGlzLmJvYXJkUm93c1t5XVt4XS5kZWx0YS5keCB8fCB0aGlzLmJvYXJkUm93c1t5XVt4XS5kZWx0YS5keTtcbiAgICB9LmJpbmQodGhpcylcblxuICAgIHRoaXMub24oJ21vdW50JywgKCkgPT4ge1xuICAgICAgdGhpcy5ibG9jayA9IG9wdHMuYnY7XG4gICAgfSk7XG5cbn0pO1xuIl19
'use strict';

riot.tag2('winlose', '<div animate="bounceIn" animate-leave="bouceOut" animate-duration="300ms"> <yield></yield> </div>', '', '', function (opts) {

  this.mixin(riotAnimate);
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndpbmxvc2UuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxLQUFLLElBQUwsQ0FBVSxTQUFWLEVBQXFCLG1HQUFyQixFQUEwSCxFQUExSCxFQUE4SCxFQUE5SCxFQUFrSSxVQUFTLElBQVQsRUFBZTs7QUFFL0ksT0FBSyxLQUFMLENBQVcsV0FBWDtBQUVELENBSkQiLCJmaWxlIjoid2lubG9zZS5qcyIsInNvdXJjZXNDb250ZW50IjpbInJpb3QudGFnMignd2lubG9zZScsICc8ZGl2IGFuaW1hdGU9XCJib3VuY2VJblwiIGFuaW1hdGUtbGVhdmU9XCJib3VjZU91dFwiIGFuaW1hdGUtZHVyYXRpb249XCIzMDBtc1wiPiA8eWllbGQ+PC95aWVsZD4gPC9kaXY+JywgJycsICcnLCBmdW5jdGlvbihvcHRzKSB7XG5cbiAgdGhpcy5taXhpbihyaW90QW5pbWF0ZSk7XG5cbn0pOyJdfQ==
//# sourceMappingURL=2048.js.map
